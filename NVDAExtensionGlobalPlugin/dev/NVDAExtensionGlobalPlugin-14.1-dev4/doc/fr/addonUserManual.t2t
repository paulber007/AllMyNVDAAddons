ADDON_SUMMARY - manuel utilisateur
Auteur: ADDON_AUTHOR_NAME


%!includeconf: ../addon_userManual.t2tconf
%!includeconf: addon_informations.t2tconf
%!includeconf: addon_keys.t2tconf

URL: [ADDON_REPOSITORY ADDON_REPOSITORY]


Téléchargement:
- [Version stable ADDON_CUR_VERSION ADDON_DOWNLOAD_SERVER1]
- [Versions de développement ADDON_DEV_URL]


Compatibilité:
- version minimum de NVDA supportée: MINIMUM_NVDA_VERSION
- dernière version de NVDA testée: LAST_TESTED_NVDA_VERSION


Traducteur (s): auteur de l'extension
= Sommaire =[toc]
%%toc

+ Introduction +
++ Généralités ++
Cette extension ajoute aux commandes globales de NVDA:
- les fonctionnalités suivantes:
 - [Affichage de la liste Des icônes de la zone de notification ou des fenêtres des applications lancées #hdr1],
 - [Aide à la composition de symboles complexes #hdr3] comme par exemple un "e" dans l'"o", un point d'interrogation renversé...,
 - [Annonce ou affichage d'informations concernant l'application sous le curseur, comme sa version, le profil de configuration actif, l'extension chargée #hdr4],
 - [Extension des fonctionnalités du tampon virtuel #hdr5] pour les navigateurs Mozilla Firefox, Microsoft Internet Explorer , Microsoft Edge et Google Chrome:
  - nouvelles commandes pour le mode de navigation : paragraphe, division, ancre, région principale,
  - nouveaux types d'éléments présentés sous forme de liste dans la boite de dialogue "Liste des éléments" ouverte par NVDA+f7: (radio bouton, paragraphe, cadre, case à cocher, ...) et annonce du nombre d'éléments correspondant au type sélectionné,
  - annonce de l'adresse (URL) du document,
  - option pour naviguer en boucle à la recherche d'un élément suivant ou précédent,
  - scripts pour cliquer à la position courante de l'objet navigateur,
  - scripts pour les tableaux:
   - annonce de la position de la cellule courante,
   - déplacement à la colonne/ligne suivante ou précédente avec lecture des cellules la composant,
   - déplacement à la première /dernière cellule de la ligne/colonne (conserver pour les versions de NVDA inférieures à la 2022.2),
   - annonce des cellules de la colonne/ligne courante.
 - [Annonce de la fonction associée aux commandes clavier d'édition #hdr7],
 - [Compléments pour le presse-papier #hdr-1] :
  - ajout dans le presse-papier du texte sélectionné,
  - vidage du presse-papier,
  - affichage du texte contenu dans le presse-papier dans une fenêtre d'information,
  - amélioration du script de base de NVDA "NVDA+c" qui annonce le texte dans le presse-papier,
 - [Annonce du dossier présélectionné dans les boites de dialogue du style "Ouvrir, Enregistrer", "Enregistrer sous" #hdr8],
 - [Ouverture du journal précédent ou courant de NVDA et copie du chemin de ceux-ci dans le presse-papier #hdr9],
 - [Historique des annonces vocales #hdr10],
 - [renommage des touches clavier #hdr12],
 - [annonce sélective des touches de commandes #hdr13],
 - [simple minuterie #hdr14],
 - [redémarrage de NVDA en niveau de journalisation "débogage" par simple geste de commande #hdr15],
 - [affichage des éléments visibles composant l'objet en avant-plan #hdr16],
 - [commutation rapide de profil vocal #hdr17],
 - [rémanence des touches NVDA et de modification et rémanence spécifique pour le site gmail.com #hdr18],
 - [Arrêt, redémarrage ou mise en veille prolongée de l'ordinateur #hdr19],
 - [gestion des gestes de commande configurés par l'utilisateur #hdr20],
 - [contrôle du son #hdr21] :
  - couper ou établir le son pour le flux audio de l'application sous le curseur,
  - établir manuellement ou automatiquement le son principal et celui du flux audio de NVDA ,
  - modifier le niveau du volume principal ou celui du flux audio de l'application sous le curseur,
  - rétablissement automatique du volume principal et de NVDA au chargement de l'extension,
  - [utilisation temporaire d'un périphérique de sortie audio sans impacter la configuration de NVDA #hdr33],
  - [orientation de la sortie audio de NVDA et des applications #hdr34],
  - [réglage du volume des tonalités et des sons de NVDA #hdr34],
 - [Outils pour le développement d'extensions #hdr22],
 - [Compléments concernant la date et l'heure #hdr24]:
  - copie de la date et l'heure dans le presse-papier,
  - Annoncer l'heure de l'horloge Windows avec les secondes,
  - annonce de l'heure indépendante du niveau de ponctuation.
 - [gestion des configurations utilisateur et redémarrage de NVDA avec une configuration précise #hdr30],
 - [analyseur de texte #hdr31],
 - [activation ou désactivation rapide des extensions # hdr35],
- Les options:
 - [suppression de l'annonce de la description des objets dans les rubans Windows #hdr100],
 - [agrandissement automatique des fenêtres #hdr102],
 - [annonce systématique des ponctuations lors de déplacement par mot #hdr103],
 - [possibilité de signaler les fautes d'orthographe par un double bip sonore, par une annonce vocale ou par l'annonce du mot mal orthographié sous un profil de configuration dédié, en lieu et place du signalement par défaut de NVDA #hdr104],
 - [possibilité de bloquer les touches "Insertion" et "Verrouillage majuscule" #hdr105],
 - [Prononciation des caractères non alphanumériques quand l'écho clavier par caractère est désactivé #hdr106].
- les options avancées:
 - [Signalement par un son de l'inscription d'une erreur dans le journal de NVDA #hdr300],
 - [Titrage des boites de dialogue de l'extension avec son nom #hdr302],
 - [configuration de la temporisation d'attente de répétition du même geste de commande #hdr303] ( pour les versions de NVDA inférieures à 2024.4),
 - [utilisation possible des touches du pavé numérique de manière standard #hdr304],
 - [possibilité de limiter la répétition de touches #hdr306],
- et les autres améliorations:
 - [menu pour explorer le dossier de configuration de l'utilisateur ou le dossier programme de NVDA #hdr202],
 - [présentation des informations de mise en forme du texte dans une boite de dialogue en lieu et place d'un document HTML #hdr203],
 - [Annonce du texte des boite de dialogue du style confirmation même si l'annonce de la description de l'objet est désactivée #hdr204].
 - [annonce de la position du curseur dans les zones d'édition #hdr32],
 - [script pour émuler la touche "Applications" #hdr25],
 - [script pour fermer toutes les fenêtres ouvertes #hdr26],
 - [script pour afficher la liste des extensions en fonctionnement #hdr27],
 - [possibilité d'exécution des scripts dans le dialogue "Gestes de commandes" de NVDA #hdr205],
 - [sélection automatique de la catégorie dans le dialogue "Gestes de commandes" #hdr206],
 - [Sélection automatique du dernier paramètre utilisé dans la boucle des paramètres du synthétiseur #hdr207],
 - [compléments pour l'explorateur Windows#hdr208] :
  - un script pour annoncer le chemin d'accès du dossier ou du fichier qui se trouve sous le curseur de l'explorateur Windows, ou copier ce chemin dans le presse-papier.
  - un script pour annoncer, en remontant l'arborescence des dossiers, le nom des dossiers composant le chemin du dossier contenant l'élément sous le curseur.


++ Menu de configuration de l'extension ++[hdr-configurationMenu]
Dans le sous-menu "Préférences" de NVDA est ajouté le sous-menu "ADDON_SUMMARY" qui propose suivant le cas, les choix suivants:
- systématiquement le sous-menu "Paramètres globaux" qui ouvre un dialogue ressemblant au dialogue "paramètres" de NVDA et qui présente les catégories suivantes:
 - "Installation des fonctionnalités": permet de voir l'état d'installation de chaque fonctionnalité apportée par l'extension et éventuellement le modifier.
 - "Compléments à NVDA": pour configurer les options liées à NVDA apportées par l'extension,
 - "Ordinateur": pour configurer les options liées aux fonctionnalités relatives à l'ordinateur (système d'exploitation Windows, contrôle du son),
 - "Clavier": pour configurer les options liées au clavier (rémanence des touches, utilisation du pavé numérique),
 - "Avancés" : options pour les utilisateurs expérimentés,
 - "mise à jour": paramètres contrôlant la mise à jour de l'extension.

- systématiquement le sous-menu "Paramètres du profil de configuration courant" qui ouvre un dialogue ressemblant au dialogue "paramètres" de NVDA et qui présente les catégories suivantes:
 - "Compléments à NVDA" : pour configurer les options liées à NVDA apportées par l'extension,
 - "Analyseur de texte" : pour définir les options spécifiques à l'analyseur de texte.
- "Renommage des touches clavier " (si la fonctionnalité est installée): permet de modifier suivant son besoin les noms des touches clavier donné par défaut par NVDA,
- "Annonce sélective des touches clavier" (si la fonctionnalité est installée): permet de faire annoncer sélectivement suivant son besoin le nom des touches clavier,
- "Réinitialiser la configuration" pour remettre la configuration dans son état initiale lors de la première installation de l'extension.


Mise à part le dernier menu, à chacun est associé un script sans geste de commande permettant de l'activer. Avec le dialogue "gestes de commandes" de NVDA il est possible de leur en attribuer un.

Ce sont les scripts suivants avec leur commande de l'interpréteur :
- "Afficher le dialogue de paramétrage de l'extension" : "KEY_ADDON_SETTINGS",
- "Afficher le dialogue de paramétrage de l'extension pour le profil de configuration courant" : "KEY_PROFILE_SETTINGS",
- "Afficher le dialogue Renommage des touches clavier" : "KEY_RENAMING",
- "Afficher le dialogue pour configurer les annonces sélectives des touches de commande" : "KEY_SELECTIVE_ANNOUNCEMENT".


Cette configuration est enregistrée de deux manières suivant la fonctionnalité ou l'options concernée:
- dans le fichier "NVDAExtensionGlobalPluginAddon.ini" placé dans le dossier utilisateur "userConfig" de NVDA pour la configuration utilisée quel que soit le profil de configuration,
- dans le fichier NVDA.ini ou le fichier du profil de configuration du profil déclenché au moment de la modification pour la configuration qui sera utilisée uniquement lorsque ce profil sera déclenché.


NVDA offre l'option "Sauvegarder la configuration en quittant" (voir manuel utilisateur de NVDA) qui permet de sauvegarder automatiquement la configuration de NVDA en quittant ou en redémarrant NVDA. Si cette option n'est pas cochée, la configuration n'est sauvegardée que sur action de l'utilisateur ou sur modification concernant un paramètre nécessitant le redémarrage de NVDA.

Cette extension suit ce mode de fonctionnement.

Certaines modifications de paramètres de l'extension nécessitent la sauvegarde de la configuration et le redémarrage de NVDA. Dans ce cas, il est proposé à l'utilisateur la sauvegarde et le rerage immédiat comme le fait NVDA lorsqu’il y a changement du langage.


Lors de la désinstallation de l'extension, son fichier de configuration est supprimé et la configuration de l'extension est effacée de tous les profils de configuration.

Lors de la désinstallation d'une fonctionnalité, sa configuration, s’il y a, est complètement supprimée.

Dans le cas d'une mise à jour, l'installation de l'extension offre la possibilité de conserver (dans la mesure du possible) ou non la précédente configuration.


À l'aide du sous-menu "Réinitialiser la configuration", il est possible de remettre la configuration dans le même état que lors de la première installation de l'extension, y compris celle enregistrée dans les profils de configuration.

Cela permet de repartir à zéro sans avoir besoin de désinstaller et réinstaller l'extension en cas de problème éventuels


++ Aide contextuelle ++
Dans la plupart des dialogues de l'extension, il est possible à l'aide de la touche "F1" d'ouvrir le manuel utilisateur de l'extension au chapitre le plus approprié.

++ Mise à jour ++[hdr-update]
La mise à jour de l'extension se fait, par défaut, automatiquement peu de temps après le démarrage de NVDA (entre 20 et 600 secondes) et au maximum une fois par jour

Il est possible de désactiver cette mise à jour en décochant l'option "Rechercher automatiquement les mises à jour" se trouvant dans la catégorie "Mise à jour».
La version de l'extension peut être:
- soit une version stable: son numéro de version est du type "8.2" par exemple.
- soit une version de développement: son numéro de version est alors du type "8.2-dev1", ou "8.1-rc1", ou "8.1-beta2".


Par défaut, une version stable est mise à jour avec une version stable plus récente (numéro de version supérieur).
Mais il est possible de mettre à jour la version stable courante avec une version de développement de la prochaine version stable. Il suffit de cocher l'option "Mettre aussi à jour les versions stables vers les versions de développement " situé dans la catégorie "Mise à jour".

Une version de développement est mise à jour:
- avec une version de développement plus récente,
- avec sa version stable,
- ou avec la dernière version stable si l'option précédente est pas cochée.


Le bouton "Rechercher une mise à jour" placé dans la catégorie "Mise à jour" vous permet de rechercher immédiatement une mise à jour.

Le bouton "Voir l'historique", placé dans cette même catégorie, vous permet d'afficher l'historique de la version actuelle dans le navigateur.

Dans le cas d'une mise à jour automatique et si une nouvelle version est détectée, la boite de dialogue "Mise à jour" s'affiche pour proposer:
- soit l'installation immédiate de la nouvelle version,
- soit de reporter la mise à jour à plus tard. Dans ce cas, la recherche se relancera au minimum une heure plus tard.


Dans le cas d'une mise à jour vers une version stable, Le bouton "Quoi de neuf" offre la possibilité d'ouvrir, dans le navigateur, l'historique de l'extension et ainsi pouvoir connaître les nouveautés de la version proposée.


++ Fonctionnement en Mode sécurisé ++
Dans ce mode, le fonctionnement de l'extension est dégradé.

Comme NVDA, il n'est pas possible d'enregistrer les modifications de configuration.

Certaines fonctionnalités ne sont plus disponibles, comme par exemple:
- "Affichage de la liste des icônes de la zone de notification et des fenêtres des applications lancées",
- "Journaux de NVDA",
- "Outils de développement".
- mise à jour de l'extension.


++ Compatibilité ++
La configuration de la fonctionnalité "Commutation de profil vocal" ayant changée, celle-ci est effacée lors d'une mise à jour à partir d'une version de l'extension plus ancienne que la 9.0. Tous les sélecteurs sont libérés et les profils vocaux associés sont supprimés.

++ Historique ++
L'historique des versions de cette extension est dans le fichier ["changes.html" changes.html]

+ Fonctionnalités +[hdr0]
++ Préambule ++[hdr0-1]
+++ Installation d'une fonctionnalité +++
Cette extension permet d'installer ou ne pas installer telle ou telle fonctionnalité.
L'état d'installation de chaque fonctionnalité de l'extension est présenté dans la catégorie "Installation des fonctionnalités" du dialogue "Paramètres.

Cet état peut être:
- Ne pas installer: la fonctionnalité n'est pas installée.
- Installer: la fonctionnalité est installée. Ses scripts sont utilisables à l'aide des commandes de l'interpréteur de commandes (voir chapitre suivant) et des gestes de commande prévus par défaut.
- Installer sans geste de commande: la fonctionnalité est installée. Ses scripts sont utilisables à l'aide des commandes de l'interpréteur de commandes (voir chapitre suivant), mais aucun geste de commande ne leur est affecté.


Par défaut, cette extension n'installe pas toutes les fonctionnalités.

+++ Activation des scripts +++[hdr0-2]
En général, chaque script peut être activé de deux manières:
- soit à l'aide d'un geste de commande classique,
- soit en utilisant l'interpréteur de commandes de l'extension (voir chapitre suivant).


Dans la boite de dialogue "Gestes de commande " de NVDA, les scripts apportés par l'extension sont placées dans leur propre catégorie.
La grande majorité des scripts se répartit dans les catégories: "ADDON_SUMMARY", "Commutation de profil vocal", "Configuration", "Outils" et Parole.

Pour les scripts pouvant être lancés par une commande de l'interpréteur, celle-ci est indiquée à la suite de la description du script.

Suivant le choix d'installation d'une fonctionnalité ("Installer, " ou "Installer sans geste de commande"), les gestes de commande prévus par défaut sont attribués ou non aux scripts de cette fonctionnalité.

Par défaut, la grande majorité des scripts pouvant être lancés par l'interpréteur de commandes ne sont affectés à aucun geste de commande.

+++ Interpréteur de commandes +++[hdr0-1-3]
Celui-ci se lance à l'aide du geste de commande "KEY_SHELL". Un bip sonore est alors audible.

Il est alors possible d'activer les scripts des fonctionnalités à l'aide de commandes.

Aujourd'hui, ces commandes ne sont pas modifiables.

La commande "KEY_HELP_SHELL" de l'interpréteur liste l'ensemble des scripts des fonctionnalités installées accessible par une commande de l'interpréteur. Dans cette liste, il est possible de lancer le script sélectionné en appuyant sur la touche "Entrée".

La commande "KEY_MODULE_GUIDE" de l'interpréteur ouvre le manuel d'utilisation de l'extension.

L'interpréteur de commandes s'arrête soit:
- en tapant la touche "Échap",
- soit automatiquement si une commande est tapée. Si cette commande ne correspond à aucun script, un bip sonore le signale.


++ Affichage de la liste des icônes de la zone de notification et de la liste des fenêtres des applications lancées ++[hdr1]
Cette fonctionnalité est, par défaut, installée avec gestes de commande.

Elle ajoute les scripts suivants:
- Affichage de la liste des icônes de la zone de notification,
- Affichage de la liste des fenêtres des applications lancées,
- Affichage de la liste des icônes de la zone de notification ou des fenêtres des applications lancées.


Ces scripts sont rangés dans la catégorie "ADDON_SUMMARY" du dialogue "Gestes de commande" de NVDA.


+++ Affichage de la liste des icônes de la zone de notification +++[hdr1-1]
Ce script initialement créé par Yannick Maillot et Daniel Poiraud s'installait à l'aide de l'extension indépendant "ListeIconesZoneNotification_v1.2.nvda-addon" qu'il faudra donc désinstaller.

Sa description est : "Afficher la liste des icônes de la zone de notification"

Il se lance par la commande "KEY_ICONS_List" de l'interpréteur de commande. Il est le pendant du script de Jaws "Insert + f11".

Aucun geste de commande ne lui est affecté par défaut.

Il affiche une boite de dialogue qui contient:
- la liste des icônes présentes dans la zone de notification,
- le bouton "Simple clic gauche" pour déclencher un simple clic gauche souris,
- le bouton "Simple clic droit" pour déclencher un simple clic droit souris,
- le bouton "Double clic gauche" pour déclencher un double clic gauche souris,
- le bouton "Annuler" pour fermer la boite de dialogue et terminer le script.


La navigation dans la boite de dialogue se fait par "Tab" ou majuscule + Tab" et dans la liste avec les flèches de direction haut et bas.

L'appui sur la touche "Échap" permet de refermer la boite de dialogue.

Dans la liste des icônes, l'appui sur la touche "Entrée" déclenche l'appui sur le bouton "Simple clic gauche".


+++ Affichage de la liste des fenêtres des applications en cours d'exécution +++[hdr1-2]
La description de ce script est: "Afficher la liste des fenêtres des application lancées avec la possibilité de basculer vers l'une d'entre elles ou de la détruire":

Il est le pendant du script de Jaws "Insert + f10".

Il se lance par la commande "KEY_WINDOWS_LIST" de l'interpréteur de commande.

Aucun geste de commande ne lui est affecté par défaut.

Il affiche une boite de dialogue qui contient:
- la liste de toutes les fenêtres des applications lancées,
- le bouton "Basculer vers" pour mettre au premier plan la fenêtre sélectionnée,
- le bouton "Détruire" pour fermer la fenêtre sélectionnée,
- le bouton "Détruire tout" pour fermer toutes les fenêtres,
- le bouton "Fermer" pour fermer la boite de dialogue et terminer le script.


La navigation dans la boite de dialogue se fait par "Tab" ou majuscule + Tab" et dans la liste avec les flèches de direction haut et bas.

Dans la liste, il est possible de sélectionner en tapant le début du titre de la fenêtre désirée.

L'appui sur la touche "Echap" permet de refermer la boite de dialogue.

Dans la liste, les fenêtres sont signalées comme agrandies ou réduites.

L'appui sur le bouton "Basculer vers" ou la touche "Entrée" quand on est dans la liste des fenêtres , ferme la boite de dialogue et amène au premier plan la fenêtre de l'application sélectionnée en lui donnant le focus.

L'appui sur le bouton "Détruire" provoque la fermeture de la fenêtre de l'application sélectionnée et le retour du focus dans la liste réactualisée des fenêtres des applications.

L'appui sur le bouton "Détruire tout" provoque la fermeture de toutes les fenêtres et celle de la boite de dialogue.

+++ Affichage de la liste des icônes de la zone de notification ou des fenêtres des applications lancées +++[hdr1-3]
La description de ce script est : "Afficher la liste des icônes de la zone de notification. Deux appuis: Afficher la liste des fenêtres des application en cours d'exécution lancées avec la possibilité de basculer vers l'une d'entre elles ou de la détruire".

Par défaut, Le geste de commande "MAIN_KEY_ICONS_List" lui est affecté.

Aucune commande interpréteur ne lui est attribuée.

Un simple appui du geste de commande lance le script "Affichage de la liste des icônes de la zone de notification" (voir ci-dessus).

Un double appui lance le script "Affichage de la liste des fenêtres des application lancées " (voir ci-dessus).


++ Aide à la composition de symboles complexes ++[hdr3]
Cette fonctionnalité est par défaut, installée sans geste de commande.

Elle ajoute les deux scripts suivants:
- un script dont la description est : "Composer un symbole complexe comme par exemple une voyelle accentuée, un symbole mathématique (",
- un script dont la description est: "Afficher la liste des derniers symboles complexes composés ".


Ces scripts sont rangés dans la rubrique "ADDON_SUMMARY" du dialogue "Gestes de commande" de NVDA.

+++ Script Composer un symbole complexe comme par exemple une voyelle accentuée, un symbole mathématique +++[hdr3-1]
Ce script se lance :
- soit par la commande KEY_COMPLEX_SYMBOL " de l'interpréteur de commande,
- soit par le geste de commande "MAIN_KEY_COMPLEX_SYMBOL " affecté par défaut.


Il affiche la boite de dialogue "Aide à la composition de symboles complexes" constituée de:
- la liste permettant de choisir une des catégories de symboles,
- la liste présentant les symboles de la catégorie sélectionnée,
- le bouton "Coller" pour insérer le symbole sélectionné dans le document courant,
- le bouton "Copier dans le presse-papier" pour copier le symbole sélectionné dans le presse-papier,
- le bouton "Gérer ses symboles" pour ajouter/ supprimer ses propres catégories ou symboles
- le bouton "Fermer" pour fermer la boite de dialogue.


On se déplace dans la boite de dialogue par "Tab" ou "Majuscule + Tab".

L'appui sur la touche "Échap" referme la boite de dialogue.

Quand on est dans la liste des catégories, l'appui sur la touche "Entrée" ou "Tab" amène le focus sur la liste des symboles de la catégorie sélectionnée.

Ces symboles sont listés suivant l'ordre du fichier "symbolCategories.dic"(voir plus loin).


Par contre, si on est dans la liste des symboles et qu'un symbole est sélectionné, l'appui sur la touche "Entrée" provoque l'appui sur le bouton "Coller".

Positionné sur un symbole, l'appui sur la touche "Espace" provoque la vocalisation du code du symbole sous la forme: code en décimal suivi du code en hexadécimal épelé. Cela peut vous servir si vous voulez composer manuellement le symbole par la commande Windows "Alt + 0" suivi du code décimal composé sur le clavier numérique.

L'appui sur l'un des trois boutons ferme la boite de dialogue.

Le bouton "Gérer ses symboles" présente la boite de dialogue qui offre la possibilité de compléter les catégories de base de l'extension par ses propres symboles.
Cette boite de dialogue affiche:
- la liste de toutes les catégories,
- la liste des symboles propres à l'utilisateur pour la catégorie sélectionnée,
- le bouton "Ajouter un symbole" pour ajouter un symbole dans la catégorie sélectionnée,
- le bouton "Supprimer le symbole" pour supprimer le symbole sélectionné,
- le bouton "Ajouter une catégorie",
- le bouton "Supprimer la catégorie" pour supprimer la catégorie (Les catégories de base ne peuvent pas être supprimées)
- le bouton "Enregistrer" pour enregistrer toutes les modifications faites et fermer la boite de dialogue,
- le bouton "Annuler" pour fermer la boite de dialogue sans modification.
Les catégories et symboles ajoutées sont mémorisées dans le fichier de configuration de l'extension (NVDAExtensionGlobalPluginAddon.ini se trouvant dans le dossier utilisateur de configuration de NVDA ) sous la section "Categories&Symbols" et sous la sous-section correspondant au langage de NVDA sous lequel les modifications ont été faites.


Chaque catégorie est une section définie comme suit:
- nom de la catégorie,
- liste des symboles (le symbole = sa description)

Les catégories de bases de l'extension avec leurs symboles sont définies dans un fichier "symbolCategories.dic" propre à chaque langage et qui se trouve dans le dossier "xxx" du dossier "locale" de l'extension (xxx étant l'identifiant du langage, par exemple "fr" pour le français).
Il est possible de personnaliser cette extension et de constituer ses propres catégories de base.
Pour cela, il suffit de créer dans le dossier userConfig, un fichier "symbolCategories-xxx.dic", enregistré en encodage "utf-8", (xx est le code de la langue). Dans ce fichier, le nom des catégories sera défini entre crochets et chaque symbole comme suit:
- le symbole (un seul caractère),
- une tabulation (caractère "Tab"),
- la description du symbole (une chaîne de caractères).


Les lignes vides ou de commentaire (commençant par "#") sont acceptées.
Ces fichiers sont conservés lors d'une mise à jour de l'extension, même si l'utilisateur demande à ne pas conserver ses propres paramètres.
L'installation de l'"extension ajoute, pour chaque langue, la prononciation de certains symboles se trouvant dans les catégories de base et que NVDA n'a pas. Le fichier "symboles-xx.dic" du dossier userConfig est soit créé, soit modifié pour y ajouter les nouvelles prononciations.



+++ Script Afficher la liste des derniers symboles complexes composés +++[hdr3-2]
Cette extension mémorise les 20 derniers symboles composés pour le profil de configuration courant.

Ce script permet de les faire afficher et de recomposer un symbole couramment utilisé. Cela évite d'aller le rechercher dans sa catégorie avec le script précédent.

Ce script se lance par la commande KEY_LAST_USED_COMPLEX_SYMBOL " de l'interpréteur de commande, Aucun geste de commande ne lui est affecté par défaut.

Il présente le même genre de boite de dialogue que le script précédent sans le bouton pour gérer ses propres symboles.

Le nombre maximum de derniers symboles est configurable avec l'option "Nombre maximum de derniers symboles composés enregistrés" placé dans la catégorie "Avancés" du dialogue "Paramètres" de l'extension.


++ Informations sur l'application sous le curseur ++[hdr4]
Cette fonctionnalité est installée par défaut sans geste de commande.

Elle installe, suivant son état d'installation, les scripts suivants :
- annonce du nom du fichier de l'application, du nom de l'extension chargé ainsi que le nom et l'état du profil de configuration,
- annonce du nom et numéro de version de l'application,


Et dans tous les cas, les scripts:
- annonce du nom et du numéro de version de l'extension activée pour l'application,
- affichage des informations sur l'application.


Ces scripts sont rangés dans la rubrique "Outils" du dialogue "Gestes de commande" de NVDA.


+++ Annonce du nom du fichier de l'application, du nom de l'extension activée et du nom et de l'état du profil de configuration +++[hdr4-1]
La description de ce script est : "Annoncer le nom de fichier de l'application en cours ainsi que le nom du module python chargé. Deux appuis : annoncer le nom et l'état du profil de configuration".

Par défaut, le geste de commande "MAIN_KEY_CONFIGURATION_PROFILE " lui est affecté.

Un simple appui du geste de commande déclenche le script de base de NVDA qui annonce le nom du fichier de l'application et s'il y a, le nom du fichier de l'extension activée.

Un double appui annonce le nom du profil de configuration et son état.

+++ Annonce du numéro de version de l'application sous le curseur +++
La description de ce script est : "Annoncer le nom et le numéro de version de l'application sous le curseur. Deux appuis: copier ces informations dans le presse-papier".

Par défaut, le geste de commande "MAIN_KEY_REPORT_NAME_VERSION " lui est affecté.

Le geste de commande déclenche au premier appui, l'annonce du nom et du numéro de version de l'application placée sous le curseur et au second appui, la copie de ces informations dans le presse-papier.


+++ Affichage des informations sur l'application sous le curseur +++[hdr4-2]
La description de ce script est: "Afficher les informations sur l'application sous le curseur".

Il se lance par la commande "KEY_APPLICATION_INFORMATIONS" de l'interpréteur.

Par défaut, Aucun geste de commande ne lui est affecté.

Il affiche la boite de dialogue "ADDON_SUMMARY - Informations" qui présente les informations suivantes:
- nom du fichier de l'application sous le curseur et son numéro de version,
- le nom du profil de configuration déclenché.
- le nom et le numéro de version de l'extension active,
- le chemin de l'extension active,
- le nom du module python chargé s'il y en a un.


+++ Affichage du nom et du numéro de version de l'extension +++[hdr4-3]
La description de ce script est: "Annoncer le nom et le numéro de version de l'extension activée pour l'application sous le curseur".

Par défaut, Aucun geste de commande ne lui est affecté, ni aucune commande interpréteur.

++ Extension des fonctionnalités du tampon virtuel ++[hdr5]
Cette fonctionnalité est installée par défaut.

Elle concerne les navigateurs Mozilla Firefox , Microsoft Internet Explorer, Google Chrome, Microsoft Edge(partiellement) et apporte:

+++ Nouvelles commandes de navigation +++[hdr5-1]
Cette extension ajoute les commandes suivantes pour le mode de navigation:
- "j" ("p" jusqu'aux versions 2024.1 de NVDA) pour aller au paragraphe suivant,
- "Majuscule + j " ("Majuscule + p" jusqu'aux versions 2024.1 de NVDA) pour aller au paragraphe précédent,
- ";" pour aller à la région principale suivante,
- "majuscule + ;" pour aller à la région principale précédente,
- "y" pour aller à la division suivante,
- "Majuscule + y" pour aller à la division précédente,
- "z" pour aller à l'ancre suivante,
- "Majuscule + z" pour aller à l'ancre précédente,
- ":" pour aller à l'élément cliquable suivant,
- "majuscule+:" pour aller à l'élément cliquable précédent.



Sauf les quatre premières, ces commandes ne sont pas implémentées dans le navigateur Microsoft Edge.

+++ Nouveaux types d'élément pour le script "NVDA + f7" +++[hdr5-2]
De base, le script intégré à NVDA et déclenché par le geste de commande "NVDA + f7", permet d'afficher la boite de dialogue "Liste d'éléments" présentant la liste de certains éléments présents dans une page Web.
Cette extension augmente le nombre de types d'éléments pouvant être choisis et affiche dans le titre du dialogue, le type sélectionné.

La liste de ces types devient:

Types de base:
- Lien,
- Titre,
- Champ de Formulaire,
- Bouton,
- Région.


Types ajoutés par l'extension:
- Bouton radio,
- Paragraphe,
- Cadre (pas dans Microsoft Edge),
- Division (pas dans Microsoft Edge),
- Cases à cocher,
- Liste déroulante,
- Tableau,
- Citation (pas dans Microsoft Edge),
- Zone d'édition,
- Liste,
- Élément de liste,
- Ancre (pas dans Microsoft Edge),
- Graphique,
- Objet embarqué (pas dans Microsoft Edge),
- Séparateur,
- cliquable (pas dans Internet Explorer ni Microsoft Edge).


Ces types sont présentés sous forme de liste au lieu de bouton radio (dans la version de base).
Un type peut être atteint en tapant la première lettre de son libellé.
Il est possible de revenir à cette liste par le raccourci "alt + t".

A chaque changement de type, Le nombre d'éléments trouvés est annoncé ou si aucun élément n'est trouvé, l'indication vocale "aucun élément" est diffusée.

Un bip sonore répétitif est audible pendant la recherche des éléments.


L'état "coché" ou non coché" est signalé pour les cases à cochées.

Le type "zone d'édition" donne la liste des zones d'édition du document, et chaque élément est présenté vocalement comme suit:
- annonce de l'étiquette de la zone s'il y en a une ou "sans étiquette" dans le cas contraire,
- annonce de "zone d'édition",
- annonce du contenu de la zone d'édition.


De même chaque champ de formulaire est présenté vocalement en fonction de son type

+++ Scripts pour les tableaux +++[hdr5-3]
Pour les navigateurs Microsoft Internet Explorer, Microsoft Edge, Mozilla Firefox, GoogleChrome, il est possible quand le curseur se trouve sur une cellule de tableau de:
- annoncer la position de la cellule courante (geste de commande KEY1_CELL_POSITION_REPORT sur ordinateur de bureau, KEY2_CELL_POSITION_REPORT sur ordinateur portable),
- annoncer les cellules de la ligne courante (geste de commande "KEY_CURRENT_ROW_REPORT"),
- annoncer les cellules de la colonne courante (geste de commande "KEY_CURRENT_COLUMN_REPORT"),
- déplacer le curseur sur la cellule de la ligne suivante, même colonne et lire les cellules de cette ligne (geste de commande "KEY_NEXT_ROW_REPORT"),
- déplacer le curseur sur la cellule de la ligne précédente, même colonne et lire les cellules de cette ligne (geste de commande "KEY_PREVIOUS_ROW_REPORT"),
- déplacer le curseur sur la cellule de la colonne suivante, même ligne et lire les cellules de cette colonne (geste de commande "KEY_NEXT_COLUMN_REPORT"),
- déplacer le curseur sur la cellule de la colonne précédente, même ligne et lire les cellules de cette colonne (geste de commande "KEY_PREVIOUS_COLUMN_REPORT").
- aller à la première cellule de la ligne (geste de commande KEY_MOVE_FIRST_CELL_ROW),
- aller à la dernière cellule de la ligne (geste de commande KEY_MOVE_LAST_CELL_ROW)
- aller à la première cellule de la colonne (geste de commande KEY_MOVE_FIRST_CELL_COLUMN),
- aller à la dernière cellule de la colonne (geste de commande KEY_MOVE_LAST_CELL_COLUMN).


Les quatre derniers scripts sont supprimés de l'extension pour les versions supérieures ou égales à 2022.2 car ils sont maintenant fournis par NVDA.

Tous ces scripts sont rangés dans la catégorie "Tableau" dans l'arborescence du dialogue "Gestes de commandes" de NVDA.

Cette extension déplace aussi dans cette catégorie les scripts de base de NVDA qui étaient rangés dans la catégorie "Divers". Ce sont:
- aller à la colonne précédente: "NVDA + contrôle + flèche gauche",
- aller à la colonne suivante: "NVDA + contrôle + flèche droite",
- aller à la ligne: précédente "NVDA + contrôle + flèche haut",
- aller à la ligne suivante: "NVDA + contrôle + flèche bas",


+++ Annonce de l'adresse du document +++[hdr5-4]
Le geste de commande "KEY1_DOCUMENT_ADDRESS", (ordinateur de bureau) ou "KEY2_DOCUMENT_ADDRESS" (ordinateur portable) tapé dans les navigateurs Mozilla FireFox, Microsoft Internet Explorer, Microsoft Edge ou Gooble Chrome, annonce l'adresse (URL) du document. Avec un double appui, cette adresse est copiée dans le presse-papier.

+++ Navigation en boucle +++[hdr5-5]
En mode navigation, la recherche de l'élément suivant ou précédent s'arrête à la fin ou au début du document.

Cette extension ajoute, en option, la possibilité de parcourir cycliquement le document, c'est à dire:
- la recherche du prochain élément continue en descendant par le début du document si la fin du document est rencontrée,
- la recherche de l'élément précédent continue en remontant par la fin du document si le début du document est rencontré.


Le passage par le début ou la fin du document est signalé par un son et un message vocal.

L'option "Navigation en boucle" de la catégorie "Compléments à NVDA" du dialogue "Paramètres" de l'extension permet d'activer ou désactiver ce fonctionnement.

Cette option n'est présentée que si la fonctionnalité "Extension des fonctionnalités du tampon virtuel" est installée.

Par défaut, cette option n'est pas cochée. Le fonctionnement de base de NVDA est conservé.



++ Scripts pour Cliquer à la position courante de l'objet navigateur ++[hdr5-6]
Ces scripts permettent de faire, avec le bouton droit ou gauche de la souris, un simple ou un double clic à la position courante de l'objet navigateur.

Ils enchaînent en fait deux types de scripts de NVDA:
- le script "Déplacer le pointeur de la souris vers l'objet navigateur courant: raccourci "NVDA + / du pavé numérique" (ordinateur de bureau) ou "NVDA + majuscule +m" (ordinateur portable),
- et les scripts pour cliquer avec le bouton de la souris:
 - simple clic gauche: "/ du pavé numérique" (ordinateur de bureau) ou "NVDA + ù" (ordinateur portable et langue NVDA française) ou "NVDA+[" (ordinateur portable et autre langue).
 - simple clic droit: "* du pavé numérique" (ordinateur de bureau) ou "NVDA+*" (ordinateur portable et langue NVDA française) ou "NVDA+]" (ordinateur portable et autre langue).


Les gestes de commandes de ces scripts sont:
- "MAIN_KEY_CLIC_LEFT_MOUSE_BUTTON_At_NAVIGATOR": faire un simple clic gauche à la position de l'objet navigateur. Le deuxième appui fait un double clic.
- "MAIN_KEY_CLIC_RIGHT_MOUSE_BUTTON_At_NAVIGATOR": faire un simple clic droit à la position de l'objet navigateur. Le deuxième appui fait un double clic.


Ces gestes de commandes peuvent être modifiés et se trouvent dans la catégorie "Souris" du dialogue "Gestes de commandes" de NVDA.

++ Annonce de la fonction associée aux commandes d'édition du style "copier", "Coller" ++[hdr7]
Cette fonctionnalité est installée par défaut.

Les fonctions déclenchées par les raccourcis "contrôle + v", "contrôle + c", "contrôle + x", "contrôle + z" n'étant pas vocalisées par NVDA, cette extension s'en charge.

Aucun contrôle sur le résultat de la fonction n'est fait.
Mais :
- pour les raccourcis "contrôle + c", "contrôle + x", l'absence de sélection de texte est signalée dans les arborescences et les listes.
- pour le raccourci "control+c", le message "copié" n'est prononcé que si le contenu du presse-papier a changé.
- pour le raccourci "control+v", l'état vide du presse-papier est signalé.


Il est fortement conseillé de ne pas installer des extensions qui fournissent le même genre de fonctionnalités.

++ Compléments pour le presse-papier ++
Les scripts suivants sont installés systématiquement par l'extension :

+++ Ajout du texte sélectionné dans le presse-papier +++[hdr7-1]
Ce script permet d'ajouter le texte sélectionné dans le presse-papier.

Il est installé sans geste de commande, mais il est possible de lui en attribuer un à l'aide du dialogue "Gestes de Commandes" de NVDA. Sa description est "Ajouter, dans le presse-papier, le texte sélectionné" et est placé dans la catégorie "ADDON_SUMMARY".

Tous les paramètres utilisés pour le script sont situés dans le groupe "Presse-papier" de la catégorie "Clavier" du dialogue de l'extension qui présente les paramètres du Profil de configuration courant.

Ce script se lance à l'aide de la commande de l'interpréteur "KEY_ADDING_TO_CLIP".

Suite à la commande, le texte sélectionné est ajouté au contenu du presse-papier, soit à la suite, soit avant suivant l'état de la case à cocher "Ajouter avant le contenu du presse-papier".

Il est possible de placer un texte de séparation entre les blocs de texte ajoutés. Ce texte est configurable à l'aide du champ d'édition nommé "Texte utilisé comme séparateur entre les contenus ajoutés au presse-papier".

Une demande de confirmation sera affichée avant de procéder à l'ajout si la case à cocher "Demander confirmation avant l'ajout dans le presse-papier" est cochée.

Note: ce script est extrait de l'extension "ClipContentsDesigner" (Auteurs Noelia, Abdel) qui fournit aussi d'autres fonctionnalités intéressantes concernant le presse-papier. Il a été mis dans cette extension sur demandes d'utilisateur qui voulaient en même temps l'annonce des fonctions "copier" et "coller".

+++ Annonce du texte dans le presse-papier de Windows +++[hdr7-2]
Ce script remplace le script de base de NVDA ("NVDA+c") pour le compléter en indiquant à l'utilisateur qui a exécuté la commande que :
- le presse-papier est vide,
- dans le cas où il n'y a pas de texte dans le presse-papier, le presse-papier peut ne pas être vide.


Le nombre de caractères lus n'est plus limité à 1024.

Ce nombre maximum peut être configuré à l'aide du choix "Nombre maximum de caractères à lire" du groupe "Presse-papier" de la catégorie "Compléments à NVDA".


+++ Vidage du presse-papier +++[hdr7-3]
Ce script est installé sans geste de commande, mais il est possible de lui en attribuer un à l'aide du dialogue "Gestes de Commandes" de NVDA.

Sa description est "Vider le presse-papier" et est placé dans la catégorie "État du système".

Sa fonction est d'effacer complètement le contenu du presse-papier de Windows. Attention, cela ne concerne pas l'historique du presse-papier de Windows.

Il se lance à l'aide de la commande interpréteur "KEY_CLEAR_CLIP".


+++ Affichage du texte contenu dans le presse-papier dans une fenêtre d'information +++[hdr7-4]
Ce script est installé sans geste de commande, mais il est possible de lui en attribuer un à l'aide du dialogue "Gestes de Commandes" de NVDA.

Sa description est "Afficher le texte du presse-papier dans une fenêtre d'information" et est placé dans la catégorie "État du système".

Sa fonction est de présenter le texte contenu dans le presse-papier dans une boite de dialogue. Il se comporte comme le script qui annonce ce texte ("NVDA+c").

Il se lance à l'aide de la commande interpréteur "KEY_DISPLAY_CLIP".

++ Annonce du dossier sélectionné dans les boites de dialogue du style "Ouvrir", "Enregistrer", "Enregistrer sous" ++[hdr8]
Cette fonctionnalité est installée par défaut sans geste de commande.

Elle ajoute, pour les boites de dialogue du style "Ouvrir", "Enregistrer", "Enregistrer sous", "Chercher dans", des scripts qui permettent de connaître le nom et le chemin du dossier qui est sélectionné pour définir l'emplacement ou le fichier sera rechercher où enregistrer.

Ces scripts sont rangés dans la catégorie "ADDON_SUMMARY" du dialogue "Gestes de commande" de NVDA.
Ce sont:
- "Annoncer le nom du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer. Deux appuis: annoncer son chemin complet": geste de commande "MAIN_KEY_SAY_CURRENT_FOLDER" qui lui est affecté par défaut.
- "Annoncer le nom du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer: commande "KEY_SAY_CURRENT_FOLDERNAME" de l'interpréteur.
- "Annoncer le chemin complet du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer: commande "KEY_SAY_CURRENT_FOLDERPATH" de l'interpréteur.


Aucun geste de commande n'est associé aux deux derniers scripts, mais il est possible de leur en associer un à l'aide du dialogue "Geste de commandes" de NVDA.

Attention, ces scripts ne fonctionnent que dans des boites de dialogue conforme au standard Windows.


++ Journaux de NVDA ++[hdr9]
Cette fonctionnalité est par défaut, installée sans geste de commande.

Elle ajoute les scripts:
- gestion des journaux de NVDA,
- Ouverture des journaux de NVDA.


Les scripts sont rangés dans la catégorie "Outils" du dialogue "Gestes de commandes" de NVDA.

+++ Gestion des journaux de NVDA +++[hdr9-1]
La description de ce script est: "Afficher le dialogue pour gérer les journaux de NVDA".

Il se lance à l'aide de la commande "KEY_LOG_VIEW" de l'interpréteur. Aucun geste de commande ne lui est affecté par défaut.

Ce script affiche la boite de dialogue "Gestion des journaux de NVDA" présentant:
- la liste déroulante pour sélectionner le journal de NVDA : courant ou précédent.
- le bouton pour ouvrir le journal sélectionné.
- le bouton pour copier dans le presse-papier le chemin du journal sélectionné.
- le bouton pour fermer le dialogue.


Le journal n'est pas directement ouvert. Il est copié auparavant dans un fichier temporaire "NVDALog.txt" ou "oldNVDALog.txt".
Ce fichier temporaire s'ouvre alors dans le programme associé à l'extension .txt. Par défaut, c'est le bloc-notes.

+++ Ouverture des journaux de NVDA +++[hdr9-2]
La description de ce script est: "Ouvrir le journal courant de NVDA. Deux appuis: ouvrir son ancien journal. Trois appuis: copier le chemin du journal courant dans le presse-papier".

Il se lance à l'aide du geste de commande "MAIN_KEY_LOG_VIEW " qui lui est affecté par défaut.

Un simple appui déclenche l'ouverture du journal courant de NVDA.

Un double appui, l'ouverture de l'ancien journal.

Un triple appui, la copie du chemin du journal courant dans le presse-papier.


Le journal n'est pas directement ouvert. Il est copié auparavant dans un fichier temporaire "NVDALog.txt" ou "oldNVDALog.txt".
Ce fichier temporaire s'ouvre alors dans le programme associé à l'extension .txt. Par défaut, c'est le bloc-notes.



++ Historique des annonces vocales ++[hdr10]
Cette fonctionnalité est installée par défaut sans geste de commande.
Afin de pouvoir réécouter des annonces vocales mal comprises ou mal entendues, cette extension enregistre un historique limité des annonces envoyées au synthétiseur.
Le nombre d'enregistrements est limité à 200.

Pour réécouter ces enregistrements, les scripts suivants, rangés dans la catégorie "Parole" du dialogue "Gestes de commande" de NVDA, sont apportés par cette fonctionnalité:
+++ Annonce du précédent enregistrement +++
Ce script se lance à l'aide du geste de commande, "MAIN_KEY_PREVIOUS_RECORD" affecté par défaut.

Le geste de commande déclenche l'annonce du précédent enregistrement par rapport au dernier enregistrement annoncé.

+++ Annonce de l'enregistrement suivant +++
Ce script se lance à l'aide du geste de commande, "MAIN_KEY_NEXT_RECORD" affecté par défaut.

Le geste de commande déclenche l'annonce de l'enregistrement suivant par rapport au dernier enregistrement annoncé.

+++ Ré-annonce du dernier enregistrement annoncé +++
La description de ce script est: "Annoncer l'enregistrement courant de l'historique des annonces vocales. Deux appuis: le copier dans le presse-papier. Trois appuis : afficher tout l'historique".

Ce script se lance à l'aide du geste de commande, "MAIN_KEY_CURRENT_RECORD" affecté par défaut.

Un simple appui déclenche l'annonce du dernier enregistrement annoncé.

Un double appui, déclenche sa copie dans le presse-papier

Un triple appui, déclenche l'affichage de tout l'historique.

+++ Affichage de l'historique vocal +++[hdr10-1]
La description de ce script est: "Afficher les enregistrements de l'historique vocal".

Ce script se lance à l'aide de la commande "KEY_DISPLAY_SPEECH_HISTORY" de l'interpréteur. Aucun geste de commande ne lui est affecté par défaut.

Il présente la boite de dialogue "Historique des annonces vocales" qui liste ces enregistrements dans l'ordre décroissant de leur ancienneté. Un bouton permet de copier dans le presse-papier l'enregistrement sélectionné.

Par défaut:
- les enregistrements sont numérotés. Cette numérotation peut être désactivée par l'option "Numéroter les enregistrements" du groupe "Historique des annonces vocal" de la catégorie "Compléments à NVDA" du dialogue "Paramètres".
- les enregistrements sont présentés dans l'ordre décroissant. L'option "Afficher les enregistrements dans l'ordre croissant" de ce même groupe permet de les afficher dans l'ordre inverse.

+++ Précisions techniques +++
Pour réaliser cette fonctionnalité, les fonctions "speak" et "speakSpelling" du module "speech.speech.py" de NVDA ont été remplacées. Les fonctions de remplacement sont communes avec la fonctionnalité "Périphérique de sortie audio temporaire".

Cela peut poser des problèmes si d'autres extensions l'ont également fait.

Pour conserver le bon fonctionnement des autres extensions, il faut désinstaller ces deux fonctionnalités.


++ Renommage des touches clavier ++[hdr12]
Cette fonctionnalité est installée par défaut.

Elle permet de renommer certaines touches du clavier comme "Verrouillage majuscule" ou "Verrouillage numérique" à l'aide d'une boite de dialogue qui présente:
- dans une liste, les touches clavier avec leur libellé défini dans NVDA,
- Le bouton "Modifier" qui permet de modifier le libellé de la touche sélectionnée dans la liste et d'entrer un libellé de remplacement à l'aide d'une boite de dialogue de saisie classique.


Lorsqu'un libellé de remplacement est défini pour la touche sélectionnée, la zone d'édition en lecture seule et atteignable par "Tab", affiche ce libellé de remplacement. Ce libellé est annoncé lorsque le focus arrive sur la touche.

Le bouton "Effacer" permet de supprimer ce libellé de remplacement.

Il est possible aussi de supprimer ce libellé en entrant une chaîne vide ou pleine de blanc dans la boite de saisie.

Le bouton " Supprimer tout" permet de supprimer tous les libellés de remplacement pour revenir aux libellés de base prévu par NVDA.

Le bouton "OK" permet d'appliquer les remplacements et d'enregistrer les touches clavier et leur libellé de remplacement dans le fichier de configuration de l'extension dans la section "RedefinedKeyLabels" et la sous-section correspondant au langage de NVDA ("fr" par exemple pour le Français). Il est ainsi possible d'avoir des renommages de touches pour différentes langues.


Pour afficher ce dialogue, trois possibilités:
- en sélectionnant et activant l'élément "Renommage des touches clavier" du sous-menu "ADDON_SUMMARY",
- avec La commande "KEY_RENAMING" de l'interpréteur,
- avec le script "Afficher le dialogue Renommage des touches clavier", prévu sans geste de commande. Un geste peut lui être affecté à l'aide du dialogue "geste de commandes " de NVDA.


Il est possible de ne pas installer cette fonctionnalité en sélectionnant, dans la catégorie "Fonctionnalités installées" et pour la fonctionnalité "Renommage des touches clavier", l'état "Ne pas Installer".


++ Annonce sélective des touches de commandes ++[hdr13]
Cette fonctionnalité est installée par défaut.

NVDA permet de faire annoncer vocalement les touches de commandes à l'aide de l'option "Dire les touches de commandes" située dans la catégorie "clavier" du dialogue "Paramètres" de NVDA ou par la commande clavier "NVDA+4".

Cette fonctionnalité apporte, par configuration et à l'aide d'une boite de dialogue, la possibilité de :
- ne pas annoncer certaines touches de commandes quand l'option "Dire les touches de commandes" est cochée,
- d'annoncer certaines touches de commandes quand l'option "Dire les touches de commandes" n'est pas cochée.


Pour afficher ce dialogue, trois possibilités:
- en sélectionnant et activant l'élément "Annonce sélective des touches de commandes" du sous-menu "ADDON_SUMMARY",
- à l'aide de La commande "KEY_SELECTIVE_ANNOUNCEMENT" de l'interpréteur,
- à l'aide du script "Afficher le dialogue pour configurer les annonces sélectives des touches de commande", prévu sans geste de commande. Un geste de commande peut lui être affecté à l'aide du dialogue "Gestes de commande" de NVDA.


Le dialogue présente:
- une case à cocher pour choisir pour quel mode, la configuration des touches est faite,
- la liste des touches possibles,
- la liste des combinaisons de touches de modification possibles avec les touches complémentaires "NVDA", "Alt", "Contrôle", "Majuscule", "Windows".


Un appui sur la barre d'espace coche ou décoche la touche ou la combinaison sélectionnée.

Si la case "Dire les touches de commandes" de la boite de dialogue n'est pas cochée, le fait de cocher une touche permet de faire annoncer quand même cette touche lorsque NVDA est configuré à ne pas les annoncer.

La liste des combinaisons de touches de modification est alors accessible et tous les éléments de cette liste sont cochés par défaut.

Pour ne pas que la touche tapée avec une combinaison particulière soit annoncer, il suffit de décocher cette combinaison.

Si l'élément "aucune" de la liste des combinaisons est coché, la touche sera annoncée même frappée sans combinaison de touche de modification.

Par contre, si la case à cocher "Dire les touches de commande" est cochée, le fait de cocher une touche permet de ne pas faire annoncer cette touche lorsque NVDA est configuré à les annoncer.

La liste des combinaisons de touches de modification est alors accessible et tous les éléments de cette liste sont cochés par défaut. Cela signifie que la touche tapée avec ou sans combinaison ne sera pas annoncée.

L'action de décocher une combinaison permet alors de faire annoncer la touche avec cette combinaison.

L'élément "aucune" de la liste des combinaisons permet de ne pas faire annoncer la touche même frappée sans combinaison de touches de modification.

Les boutons "Décocher tout" et "Cocher tout" permettent de décocher ou cocher la totalité des éléments de la liste des combinaisons de touche de modification.

Le premier élément "toute touche avec combinaison de touches de modification" de la liste des touches permet, sans désigner une touche particulière, de sélectionner un ensemble de combinaisons de touches de modification. Toute touche tapée avec une de ces combinaisons sera, suivant le mode de configuration choisi, annoncée ou non.

Le bouton "OK" enregistre les choix faits pour le profil de configuration courant, tandis que le bouton "Annuler" les oublie.

Dans les listes, la touche "F2" et la combinaison de touche "majuscule+F2" permettent de se déplacer respectivement à l'élément coché suivant ou précédent.

Il est possible de ne pas installer cette fonctionnalité en sélectionnant, dans la catégorie "Fonctionnalités installées" et pour la fonctionnalité "Annonce sélective des touches de commande", l'état "Ne pas Installer».

+++ Précisions techniques +++
Pour réaliser cette fonctionnalité, la fonction "executeGesture" de "inputCore.manager" a été remplacée. Cette modification est commune avec la fonctionnalité "Rémanence des touches".

Si cette modification cause un conflit avec d'autres extensions, les deux fonctionnalités doivent être désinstallées.


++ Minuterie ++[hdr14]
Cette fonctionnalité est installée par défaut.

Elle permet de lancer une minuterie pour une durée programmable.
A L'échéance de la minuterie une boite de dialogue apparaît en affichant une annonce programmable et l'émission d'une sonnerie.

Elle installe un script qui se lance:
- soit par La commande "KEY_MINUTE_TIMER"de l'interpréteur de commandes,
- soit par le geste de commande "MAIN_KEY_MINUTE_TIMER " affecté par défaut.


Si la minuterie est arrêtée, le script affiche la boite de dialogue "Lancement de la minuterie" qui présente:
- la zone d'édition de la durée de la minuterie(en minutes),
- la zone d'édition de l'annonce affichée à l'échéance de la minuterie,
- la liste pour choisir le délai pour être averti avant l'échéance de la minuterie,
- le bouton "Options de sonnerie" pour configurer le nombre de sonnerie et le temps entre les sonneries.


La durée, l'annonce et le délai pour être averti avant l'échéance de la minuterie sont enregistrés à chaque lancement de la minuterie et affichés par défaut au lancement suivant de celle-ci.

Si la minuterie est en cours, le script affiche alors la boite de dialogue "Minuterie en cours" permettant de connaître la durée restante de la minuterie et éventuellement d'arrêter la minuterie.

La durée est réactualisée toute les 5 secondes et est annoncée quand le focus se trouve dans la zone d'édition (en lecture seule) l'affichant.

Cette boite de dialogue se ferme automatiquement à l'échéance de la minuterie.

++ Redémarrage de NVDA ++[hdr15]
Cette fonctionnalité n'est pas installée par défaut.

Elle installe un script qui permet de redémarrer NVDA en niveau de journalisation débogage sans modifier la configuration de NVDA.

La description de ce script est: "Redémarrer NVDA. Deux appuis: redémarrer en niveau de journalisation débogage".

Il est rangé dans la catégorie "Divers" du dialogue "Gestes de commandes" de NVDA.

Le geste de commande "MAIN_KEY_RESTART_NVDA " lui est affecté par défaut.

Un simple appui de ce geste déclenche le redémarrage de NVDA avec le niveau de journalisation configuré dans les préférences générales.

Un double appui de ce geste de commande redémarre NVDA avec le niveau de journalisation débogage sans modifier le niveau de journalisation configuré dans les préférences générales de NVDA.


++ Affichage des éléments visibles de l'objet en avant plan ++[hdr16]
Par défaut, cette fonctionnalité est installée avec geste de commande.

Elle installe deux scripts rangés dans la catégorie "Focus système" du dialogue "Gestes de commande" de NVDA:

+++ Affichage des éléments visibles de l'objet sous le curseur +++
La description de ce script est: "Afficher les éléments visibles composant l'objet en avant plan".

Il se lance à l'aide de la commande "KEY_OBJECTS_LIST" de l'interpréteur.

Aucun geste de commande ne lui est attribué.

Le script lance la recherche de ces éléments. Celle-ci peut prendre un temps conséquent. Un signal sonore toute les deux secondes est émis pendant cette recherche.

Pour limiter ce temps de recherche, des limites sont mise en place pour certains types d'éléments:
- le nombre de lignes maximum d'un tableau est fixé à 40,
- le nombre d'éléments d'une arborescence est fixé à 40,
- le nombre maximum d'éléments d'une liste est fixé à 40,
- les éléments composant un document ne sont pas pris en compte, ni ceux d'un tableau, d'une arborescence et d'une liste dont le nombre d'éléments dépasse 500.


La recherche terminée, les éléments sont affichés dans la boite de dialogue "Liste des éléments visibles composant l'objet en avant plan", suivant leur type.

Cette boite de dialogue présente :
- la case à cocher pour choisir si les éléments sans étiquette, ni description doivent être pris en compte ou non (par défaut, les éléments non étiquetés ne sont pas pris en compte),
- la liste des types d'éléments disponible,
- la liste des éléments pour le type sélectionné,
- le bouton pour faire un clic souris gauche sur l'élément sélectionné (bouton par défaut quand on est dans la liste des objets),
- le bouton pour faire un clic souris droit sur l'élément sélectionné,
- le bouton pour amener l'objet navigateur de NVDA et le pointeur souris sur l'élément sélectionné,
- le bouton pour quitter le dialogue.


Dans la liste des éléments, il est possible de changer le type des objets à lister sans quitter la liste:
- soit en utilisant les flèches de direction gauche ou droite,
- soit en tapant "contrôle+majuscule+la première lettre du type d'objet désiré".


Toujours dans cette liste, il est possible d'atteindre un élément en tapant les premières lettres de son étiquette.

Pour un élément de type:
- bouton ou case à cocher: l'état de l'élément est indiqué.
- zone d'édition: l'état en lecture seule est indiqué.


+++ Annonce ou affichage des éléments visibles de l'objet sous le curseur +++
La description de ce script est: "Dire l'objet en avant-plan. Deux appuis: afficher les éléments visibles composant l'objet en avant plan".
Il se lance à l'aide du geste de commande "MAIN_KEY_OBJECTS_LIST " qui lui est affecté par défaut.

Un simple appui lance le script de base de NVDA qui annonce tous les objets de l'objet en avant plan.

Un double appui lance le script précédent "Affichage des éléments visibles de l'objet en avant plan".


++ Commutation rapide de profil vocal ++[hdr17]
Cette fonctionnalité est installée par défaut sans geste de commande.

Elle permet de changer rapidement de profil vocal en donnant la possibilité de mémoriser jusqu'à 8 profils vocaux et de sélectionner rapidement un de ces profils vocaux.

Un profil vocal est défini par:
- le synthétiseur vocal utilisé et ses paramètres vocaux de configuration (comme "voix", "volume", "débit", ...),
- les paramètres vocaux de configuration de NVDA (comme "Niveau de ponctuations et symboles", "Dire majuscule après les majuscules", ...).


Elle installe les scripts suivants rangés dans la catégorie "Commutation de profil vocal" du dialogue "Gestes de commande" de NVDA:

+++ Gestion des sélecteurs de profil vocal +++[hdr17-1]
La description de ce script est: "Afficher le dialogue pour gérer les sélecteurs de profil vocal".

Il se lance:
- soit à l'aide de la commande "KEY_MANAGE_VOICE_PROFIL" de l'interpréteur,
- soit à l'aide du geste de commande "MAIN_KEY_MANAGE_SELECTOR " qui lui est affecté par défaut.


Ce script affiche la boite de dialogue "Gestion des sélecteurs de profil vocal du profil de configuration NomDuProfil" (où NomDuProfil est le nom du profil de configuration déclenché).

Cette boite de dialogue permet de gérer l'association sélecteur- profil vocal et présente:
- la case à cocher "Utiliser les sélecteurs associés sous le profil de configuration normale",
- la liste " sélecteurs",
- le bouton "Activer",
- le bouton "Associer le profil vocal",
- le bouton "Modifier le profil vocal",
- le bouton "Libérer le sélecteur",
- le bouton "libérer tous les sélecteurs",
- le bouton "Informations sur le profil vocal",
- le bouton "Fermer".


La liste "Sélecteurs" présentent la liste des sélecteurs libres ou associés à un profil vocal. Les sélecteurs associés sont:
- ceux qui ont été associés sous le profil de configuration courant (son nom est indiqué dans le titre du dialogue),
- ceux qui ont été associé sous le profil de configuration normale si la case à cocher "Utiliser les sélecteurs associés sous le profil de configuration normale" est cochée. L'indication "configuration normale" est alors indiquée pour ces sélecteurs.

Lorsque le sélecteur est indiqué "libre", le bouton "Associer le profil vocal" permet d'associer le profil vocal courant à ce sélecteur. Ce bouton fait apparaître une boite de dialogue permettant de donner un nom à ce profil vocal. Un nom par défaut est proposé. Le bouton "Défaut" permet de revenir à cette proposition.

Lorsqu'un sélecteur est déjà associé à un profil vocal il est alors possible:
- d'activer ce profil vocal avec le bouton "Activer le profil vocal": le profil devient le profil vocal courant et la boite se referme.
- d'associer le profil courant au sélecteur à l'aide du bouton "associer le profil vocal". Ce profil remplace alors le profil vocal associé à ce sélecteur,
- de modifier le nom du profil vocal avec le bouton "Modifier le profil vocal",
- de rompre l'association entre le sélecteur et le profil vocal avec le bouton "Libérer le sélecteur".
- de rompre toutes les associations avec le bouton "Libérer tous les sélecteurs".


Si le sélecteur sélectionné est un sélecteur associé sous le profil de configuration normal, il n'est alors pas possible de le libérer, mais il peut être associé au profil courant.
Seuls les sélecteurs associés sous le profil de configuration courant peuvent être libérés.
+++ Mode "Commutation de profil vocal" +++[hdr17-2]
Pour changer rapidement de profil vocal, le mode "Commutation de profil vocal" est mis en place et un script permet de l'activer ou le désactiver.

La description de ce script est : "Activer ou désactiver le Mode commutation de profil vocal".

Pour lancer ce script, deux possibilités:
- soit en tapant la commande "KEY_VOICE_PROFIL_SWITCHING" de l'interpréteur,
- soit à l'aide du geste de commande "MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING" (non installé par défaut).


Ce mode activé, les flèches droite ou gauche permettent de se déplacer au premier sélecteur suivant ou précédent associé à un profil vocal et ainsi définir le profil vocal associé à ce sélecteur comme profil vocal courant.

Les sélecteurs prisent en compte sont les sélecteurs de la liste "Sélecteurs" qui sont associés à un profil vocal.

+++ Choix du Sélecteur de profil vocal précédent +++
La description de ce script est : "Aller au premier sélecteur précédent associé à un profil vocal et définir ce profil vocal comme profil vocal courant".

Il se lance à l'aide du geste de commande "MAIN_KEY_PREVIOUS_VOICEPROFILE" qui lui affecté par défaut.

Le script recherche, dans la liste "Sélecteurs", le premier sélecteur précédent le sélecteur courant associé à un profil vocal. Puis il positionne ce profil vocal comme profil vocal courant.


+++ Choix du Sélecteur de profil vocal suivant +++
La description de ce script est : "Aller au premier sélecteur suivant associé à un profil vocal et définir ce profil vocal comme profil vocal courant".

Il se lance à l'aide du geste de commande "MAIN_KEY_NEXT_VOICEPROFILE" qui lui affecté par défaut.

Le script recherche, dans la liste "Sélecteurs", le premier sélecteur de profil vocal suivant le sélecteur courant associé à un profil vocal. Puis il positionne ce profil vocal comme profil vocal courant.

+++ Choix du sélecteur de profil vocal par son numéro +++
8 scripts sont installés.
La description de ces scripts est: «Positionner le sélecteur x comme sélecteur courant et définir, si possible, son profil vocal associé comme profil vocal courant" (où x est le numéro du sélecteur).

Chaque script se lance à l'aide du geste de commande "MAIN_KEY_VOICEPROFILE_SELECTOR" affecté par défaut.

Le script sélectionne le sélecteur x et s'il est associé à un profil vocal, positionne ce profil vocal comme profil vocal courant.


+++ Annonce ou affichage des paramètres vocaux courants +++[hdr17-6]
Les 3 scripts suivants permettent de connaître les paramètres vocaux actuels sans avoir besoin d'utiliser le menu "Parole" de NVDA.

Ils sont rangés dans la catégorie "Parole" du dialogue "Gestes de commandes" de NVDA et sont installés même si la fonctionnalité "Commutation de profil vocal" n'est pas installée.

Aucun geste de commande ne leur sont associé, mais il est possible de leur en attribuer un à chacun.

Leurs descriptions sont :
- "Annoncer les paramètres vocaux actuels" : se lance avec la commande"KEY_REPORT_SPEECH_SETTINGS" de l'interpréteur de commande.
- "Afficher les paramètres vocaux actuels": se lance avec la commande "KEY_DISPLAY_SPEECH_SETTINGS" de l'interpréteur de commande.
- "Annoncer les paramètres vocaux actuels. Deux appuis: les afficher": aucune commande de l'interpréteur ne lui est associée.


+++ Enregistrement automatique des paramètres vocaux lors d'une commutation de profil +++[hdr17-7]
Les paramètres vocaux courant peuvent être automatiquement enregistrés pour le sélecteur courant lors d'une commutation de profil vocal.

Cela a pour but d'éviter d'être obligé de réassocier manuellement le profil vocal au même sélecteur si des paramètres vocaux ont été modifiés, comme par exemple le débit, le volume et de perdre ces modifications en basculant sur un autre profil vocal si ce n'est pas fait.

Évidemment il faut que le sélecteur courant soit associé à un profil vocal. Si ce n'est pas le cas, il n'y aura pas d'enregistrement.

Cette fonctionnalité est configurable et n'est pas activée par défaut.

Pour l'activer, il faut cocher l'option "Enregistrer automatiquement les paramètres vocaux actuels pour le sélecteur courant avant la commutation " qui se trouve dans la catégorie "Avancé" des paramètres globaux de l'extension.


++ Rémanence des touches NVDA et de modification ++[hdr18]
Cette fonctionnalité n'est pas installée par défaut.

Elle permet de rendre rémanente les touches NVDA ("Insert" du pavé numérique normal ou étendu, la touche "Verrouillage majuscule") et les touches de modification ("majuscule", "contrôle", "Alt gauche", "Contrôle Alt droit", "Windows").

L'objectif étant de pouvoir n'utiliser qu'un seul doigt par exemple pour composer un geste de commande nécessitant l'appui sur plusieurs touches.

Elle place un groupe "Rémanence des touches" dans la catégorie "Clavier" du dialogue "Paramètres" de l'extension.

Pour activer ou désactiver la rémanence des touches, il suffit de composer l'une des séquences de touches clavier suivante:
- "Majuscule droit", "Contrôle droit", "majuscule droit",
- "majuscule gauche", "contrôle gauche", "majuscule gauche".

La rémanence des touches peut être activée automatiquement au démarrage de NVDA en cochant la case à cocher "Activer la rémanence des touches au démarrage de NVDA" du groupe "Rémanence des touches".

L'activation ou la désactivation de la rémanence est signalée vocalement.

Quand la rémanence est activée, l'appui sur une des touches NVDA ou de modification déclenche une temporisation et la touche est mémorisée.
Cette temporisation est configurable par l'option "durée de la rémanence des touches" du groupe "Rémanence des touches".

Il est aussi possible de limiter la rémanence à la seule touche "NVDA" en cochant la case à cocher "Seule la touche NVDA est rémanente" située dans le même groupe. Par défaut, cette case n'est pas cochée et toutes les touches de modification sont rémanentes.

Le début et la fin de cette rémanence est signalée par un bip qui peut être désactivé à l'aide des cases à cocher suivantes de la catégorie "Rémanence des touches":
- Émettre un bip au démarrage de la rémanence d'une touche,
- Émettre un bip à la fin de la rémanence d'une touche.


Elles sont cochées par défaut.

Pendant cette temporisation, tout nouvel appui sur une de ces touches relance la temporisation et cette nouvelle touche est elle aussi mémorisée, mais aucun bip n'est émis.

L'appui sur toute autre touche du clavier exécute le geste de commande composé de la combinaison de toutes les touches mémorisées avec cette dernière touche.

A chaque fois que cette dernière touche sera de nouveau tapée pendant la temporisation, le geste de commande sera de nouveau exécuté.

Si cette touche est tapée hors temporisation, elle est exécutée seule et les touches mémorisées sont oubliées.

Attention:
Il faut attendre la fin de la rémanence pour faire traiter toute nouvelle touche individuellement. Par exemple: "Alt" pour faire apparaître un menu puis dérouler les éléments du menu.

Il est cependant possible d'arrêter la rémanence avant la fin de la temporisation, en retapant la dernière touche rémanente.


+++ Rémanence spécifique pour le site gmail.com +++[hdr18-1]
Cette rémanence est spécifiquement mise en place pour le site gmail.com et n'est active uniquement dans la page "https://mail.google.com/mail/#i".

Elle n'est pas active par défaut. Une case à cocher "Rémanence spécifique pour gmail.com" est prévue dans le groupe "Rémanence des touches".

Dans cette page, il est possible de taper des raccourcis pour lancer des commandes mais certains d'entre eux enchaînent deux lettres. En particulier, les lettres "g", "h", "*" doivent être suivi d'une autre lettre.
Cet enchaînement doit être assez rapide pour provoquer l'exécution de la commande associée.
Cela pose problème aux personnes qui n'ont pas la dextérité suffisante.

L'objectif de cette rémanence est donc de retenir la première lettre en attendant que la seconde soit frappée.

Lorsque la première lettre est frappée, une temporisation est démarrée (un bip sourd est audible) et la lettre est mémorisée.

La frappe de la seconde lettre dans le délai de rémanence configuré provoque l'envoi des deux lettres au navigateur et la temporisation est arrêtée.

Si aucune nouvelle lettre n'est frappée, la première lettre est envoyée au navigateur à l'échéance de la temporisation (un bip aigu est audible).

Afin que NVDA envoie les lettres au navigateur, il est nécessaire de basculer en mode formulaire avant toute chose.



++ Arrêt de l'ordinateur ++[hdr19]
Cette fonctionnalité ne peut pas être désinstallée.

Elle installe un script dont la description est: "Afficher le dialogue pour arrêter, redémarrer ou mettre en veille l'ordinateur".

Il se lance à l'aide de La commande "KEY_SHUTDOWN" de l'interpréteur.
Ce script affiche un dialogue composé des éléments suivants:
- un bouton pour arrêter l'ordinateur,
- un bouton pour redémarrer l'ordinateur,
- un bouton pour mettre en veille prolongée l'ordinateur,
- une case à cocher pour, si elle est cochée (état par défaut), demander la fermeture sans avertissement de toutes les applications lancées au moment de l'appui sur l'un des deux premiers boutons,
- un champ d'édition pour définir le temps d'attente avant la mise en veille, l'arrêt ou le redémarrage de l'ordinateur,
- le bouton "Annuler" pour fermer la boite de dialogue.


Cette fonctionnalité installe aussi les scripts correspondants aux fonctions des trois boutons, mais avec le comportement suivant :
- fermeture sans avertissement de toutes les applications lancées pour l'arrêt ou le redémarrage,
- l'arrêt, le redémarrage ou la mise en veille est immédiat.


Dans le cas où un temps d'attente non nul est configuré, une boite de dialogue présente alors le temps d'attente restant avant la mise en veille, l'arrêt ou le redémarrage de l'ordinateur.

Le bouton "Annuler" ou la touche "Échapp" permet d'interrompre la demande.

Le signalement du temps d'attente restant respecte l'option "suivi des barres de progression" de NVDA.

Le bouton "Annoncer le temps d'attente restant" permet de lire le temps d'attente affiché dans la boite de dialogue.

Tous les scripts sont rangés dans la catégorie "ADDON_SUMMARY" du dialogue "Gestes de commande" de NVDA, mais aucun geste ne leur est affectés.


++ Gestion des gestes de commandes utilisateur ++[hdr20]
Cette fonctionnalité ne peut pas être désinstallée.

De base, NVDA permet d'ajouter ou de supprimer des gestes de commande à l'aide du dialogue "gestes de commande". Mais il n'y a aucun moyen de savoir quels sont les gestes ajoutés ou supprimés par l'utilisateur.
C'est à ce besoin que veut répondre cette fonctionnalité.

Pour cela, Elle ajoute le script dont la description est "Afficher le dialogue pour gérer les Gestes de commande configurés par l'utilisateur" et placé dans la catégorie "ADDON_SUMMARY" du dialogue "Gestes de commandes" de NVDA.

Il se lance à l'aide de la commande "KEY_USER_INPUT_GESTURE " de l'interpréteur. Aucun geste de commande ne lui est affecté par défaut.

Ce script affiche un dialogue du style "gestes de commande" de NVDA en sélectionnant uniquement les gestes de commandes supprimées ou modifiées par l'utilisateur.

Le dialogue présente:
- l'arborescence classique qui présente les gestes de commande par catégorie et chaque script par sa description,
- un bouton "Supprimer" (actif quand un geste est sélectionné) pour annuler l'ajout ou la suppression du geste sélectionné,
- un bouton pour annuler tous les ajouts ou suppression de gestes de commande.


Les gestes de commandes supprimés d'une catégorie sont présentés avec la description: "Gestes de commande supprimées".

Comme il n'est pas possible de connaître la catégorie et la description d'un geste de commande supprimés ou d'un geste de commande ajouté associé à un script d'une extension qui n'est pas activée ou pas installé au moment de l'affichage du dialogue ,ce geste est présenté comme ceci:
- la catégorie est nommée : " nom du module python». Nom de la class python" (par exemple: appModules.notepad++.editWindow.EditWindow),
- la description des gestes de commande ajoutés est nommée: "nom du script python"(par exemple: goToPreviousBookmark ).


Comme pour le dialogue "gestes de commandes" classique, ce n'est que sur appui sur le bouton "OK" que toutes les suppressions de geste seront prises en compte.

L'annulation de toutes les modifications à l'aide du bouton "Supprimer tout" est soumise à confirmation. Sur acceptation, toutes les modifications sont annulées et le dialogue se referme.


++ Contrôle du son ++[hdr21]
Par défaut, cette fonctionnalité est installée sans geste de commande.

Elle ne peut fonctionner que sous les systèmes d'exploitation Windows 10 ou Windows 11.

Si elle est installée avec ou sans geste de commande, Elle place le groupe "Contrôle du son" dans la catégorie "Ordinateur" du dialogue "Paramètres".

Elle installe la gestion du rétablissement du son au démarrage de l'extension et les scripts suivants rangés sous la catégorie "Contrôle du son" dans le dialogue "Gestes de commandes":

+++ Établissement manuel du son principal et du flux audio de NVDA +++[hdr21-1]
Ce script se lance:
- soit à l'aide de la commande "KEY_VOLUME_ON" de l'interpréteur,
- soit à l'aide du geste de commande "MAIN_KEY_VOLUME_ON" affecté par défaut.


Il établit le volume du périphérique de sortie audio qu'utilise NVDA et celui du flux audio de NVDA et force les niveaux de chacun aux valeurs des niveaux de rétablissement configurées dans le groupe "Contrôle du son" de la catégorie "Ordinateur" des paramètres de l'extension.

+++ Coupure ou établissement du son du flux audio de l'application placée sous le curseur +++[hdr21-2]
Ce script se lance:
- soit à l'aide de la commande "KEY_TOGGLE_MUTE" de l'interpréteur de commande,
- soit à l'aide du geste de commande "MAIN_KEY_TOGGLE_MUTE" affecté par défaut.


Cette commande coupe le son du flux audio de l'application placée sous le curseur s'il est établi ou le rétablit s'il est coupé.

+++ Modification du volume du flux audio de l'application sous le curseur +++[hdr21-3]
Ces scripts permettent d'augmenter, diminuer ou fixer le volume du flux de l'application présente sous le curseur.

Ils sont installés sans gestes de commandes. Mais il est toujours possible de leur en attribuer avec le dialogue "Gestes de commandes".

Ils se lancent à l'aide des commandes suivantes de l'interpréteur:
- "KEY_APP_VOLUME_UP" ou "KEY_APP_VOLUME_DOWN" pour augmenter ou diminuer le volume,
- "KEY_APP_VOLUME_MAX" ou "KEY_APP_VOLUME_MIN" pour maximiser ou minimiser le volume.
- un chiffre de 1 à 9 pour fixer le niveau du volume à 10%, 20%, 30%,..., 90% du volume principal.


Ces commandes, contrairement aux autres commandes de l'interpréteur, peuvent être répéter sans être obliger de relancer celui-ci. L'interpréteur reste toujours actif.

Une fois le niveau de volume atteint, il faut taper sur la touche "Échapp" pour quitter l'interpréteur.

L'augmentation ou la diminution du volume se fait par pas. Il est possible de régler la taille de ces pas dans les paramètres de l'extension sous la catégorie "Ordinateur", groupe "Contrôle du son", en choisissant la taille du pas.

La taille 1 correspond au plus petit pas, la taille 20 au plus grand pas. La taille est réglée par défaut sur 5.

Par défaut, le niveau du volume de l'application ne peut pas dépasser le niveau du volume principal.

Mais cette limitation peut être outrepassée si l'option "Augmenter le volume principal si nécessaire" est cochée. Cette option se trouve dans le groupe "Modification du volume" de la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension.

+++ Modification du volume de NVDA +++[hdr21-8]
Ces scripts permettent d'augmenter, diminuer, ou fixer le volume de NVDA.

Ils sont installés sans gestes de commandes. Mais il est toujours possible de leur en attribuer avec le dialogue "Gestes de commandes".

Ils se lancent à l'aide des commandes suivantes de l'interpréteur:
- "KEY_NVDA_VOLUME_UP" ou "KEY_NVDA_VOLUME_DOWN" pour augmenter ou diminuer le volume,
- "KEY_NVDA_VOLUME_MAX" ou "KEY_NVDA_VOLUME_MIN" pour maximiser ou minimiser le volume,
- "majuscule + un chiffre de 1 à 9" pour fixer le niveau du volume de NVDA à 10, 20, 30, ..., 90 pourcent du volume principal.


Ces commandes, contrairement aux autres commandes de l'interpréteur, peuvent être répéter sans être obliger de relancer celui-ci. L'interpréteur reste toujours actif.

Une fois le niveau de volume atteint, il faut taper sur la touche "Échapp" pour quitter l'interpréteur.

L'augmentation ou la diminution du volume se fait par pas. Il est possible de régler la taille de ces pas dans les paramètres de l'extension sous la catégorie "Ordinateur", groupe "Contrôle du son", en choisissant la taille du pas.
La taille 1 correspond au plus petit pas, la taille 20 au plus grand pas. Par défaut, la taille est réglée sur 5, ce qui correspond à 5 échelons de variation du volume dans le mélangeur de Windows.

Le volume de NVDA ne peut pas devenir inférieur au seuil de rétablissement configuré.

Par défaut, il ne peut pas être supérieur au volume principal, mais cette limitation peut être outrepassée si l'option "Augmenter le volume principal si nécessaire" est cochée. Cette option se trouve dans le groupe "Modification du volume" de la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension.


+++ Modification du volume principal +++[hdr21-4]
Ces scripts permettent d'augmenter, diminuer, ou fixer le volume principal du périphérique de sortie audio utilisé par l'application sous le focus (y compris NVDA) ou celui par défaut de Windows si l'application sous le focus n'en utilise aucun.


Ils sont installés sans gestes de commandes. Mais il est toujours possible de leur en attribuer avec le dialogue "Gestes de commandes".

Ils se lancent à l'aide des commandes suivantes de l'interpréteur:
- "KEY_MAIN_VOLUME_UP" ou "KEY_MAIN_VOLUME_DOWN" pour augmenter ou diminuer le volume,
- "KEY_MAIN_VOLUME_MAX" ou "KEY_MAIN_VOLUME_MIN" pour maximiser ou minimiser le volume,
- "contrôle+ un chiffre de 1 à 9" pour fixer le niveau du volume principal à 10, 20, 30, ..., 90,


Ces commandes, contrairement aux autres commandes de l'interpréteur, peuvent être répéter sans être obliger de relancer celui-ci. L'interpréteur reste toujours actif.

Une fois le niveau de volume atteint, il faut taper sur la touche "Échapp" pour quitter l'interpréteur.

L'augmentation ou la diminution du volume se fait par pas. Il est possible de régler la taille de ces pas dans les paramètres de l'extension sous la catégorie "Ordinateur", groupe "Contrôle du son", en choisissant la taille du pas.
La taille 1 correspond au plus petit pas, la taille 20 au plus grand pas. Par défaut, la taille est réglée sur 5, ce qui correspond à 5 échelons de variation du volume dans le mélangeur de Windows.

Le volume principal ne peut pas devenir inférieur au seuil de rétablissement configuré.

+++ Retour au précédent niveau +++[hdr21-5]
Lors de l'utilisation des commandes précédentes, le niveau du volume est enregistré avant l'exécution de chaque commande, pour le périphérique audio, pour NVDA et pour chaque application.

Pour revenir à ce niveau, les commandes suivantes sont disponibles:
- "KEY_MAIN_VOLUME_PREVIOUS_LEVEL": pour remettre le niveau du volume du dernier périphérique audio utilisé au précédent niveau.
- "KEY_NVDA_VOLUME_PREVIOUS_LEVEL": pour remettre le niveau du volume de NVDA à son précédent niveau.
- "KEY_APP_VOLUME_PREVIOUS_LEVEL": pour remettre le niveau du volume de l'application sous le curseur à son précédent niveau.


Le niveau précédent est également enregistré à l'exécution de ces commandes.

Ces enregistrements ne sont pas conservés lors d'un redémarrage de NVDA.

+++ Annonce des changements de niveau +++[hdr21-6]

Les changements de niveau du volume sont annoncés par défaut. Le nom du périphérique de sortie audio est aussi annoncé lors du premier changement de volume pour ce périphérique.

Mais il est possible de désactiver cette annonce à l'aide de l'option "Annoncer les modifications de volume" du groupe "Modification du volume" de la catégorie "Ordinateur".

+++ Rétablissement automatique du son principal et de NVDA au chargement de l'extension +++[hdr21-7]
Cette fonctionnalité permet de rétablir, au chargement de cette extension, le volume de la source audio NVDA et celui du périphérique de sortie audio qu'elle utilise en positionnant le niveau de chacun à une valeur définie par configuration dans le cas où celui-ci est inférieur au seuil minimum défini par configuration.

Pour cela, le groupe "Contrôle du son" de la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension, présente les éléments de configuration suivants:
- la case à coché "Établir automatiquement le son au chargement de l'extension" qui permet d'activer ou désactiver cette option,
- le seuil de rétablissement du volume principal en dessous duquel son niveau sera automatiquement rétabli,
- le niveau du volume principal à rétablir,
- le seuil de rétablissement du volume de NVDA en dessous duquel son niveau sera rétabli (en pourcentage de celui du volume principal),
- le niveau du volume de NVDA à rétablir (en pourcentage du volume principal).
- la case à cocher "Au démarrage, mettre NVDA sur les deux canaux".


Lorsque la case à coché "Établir automatiquement le son  au chargement de l'extension" est cochée, l'extension vérifie, à son lancement, que le volume du périphérique de sortie audio et celui de NVDA sont au-dessus du seuil de rétablissement configuré pour chacun.

Si ce n'est pas le cas, cette extension fixe alors le niveau du volume à la valeur du niveau à rétablir configurée.

Lors de l'installation de cette extension, les niveaux courants du volume de NVDA et du périphérique de sortie audio utilisé par NVDA sont pris en compte pour définir les valeurs des niveaux à rétablir.

Par défaut, l'extension met en même temps NVDA sur les deux canaux et au même niveau de volume. Le niveau de volume fixé est le plus grand des volumes entre les deux canaux.

Il est possible de désactiver ce fonctionnement à l'aide de la case à cocher "Au démarrage, mettre NVDA sur les deux canaux" .

Pour les versions de NVDA supérieures à la 2024.2, ce fonctionnement est aussi désactivé automatiquement si le mode de séparation du son de NVDA n'est pas désactivé, quel que soit l'état de cette case à cocher. Dans ce cas, c'est NVDA qui gère l'éta des canaux pour NVDA à son démarrage suivant le mode de séparation du son configuré.

++ Compléments concernant la date et l'heur ++[hdr24]
Cette fonctionnalité est installée par défaut sans geste de commande.

Attention: installée avec geste de commande, cette fonctionnalité peut être en conflit avec l'extension "Clock" car le geste de commande "nvda+f12" est en commun.

Cette fonctionnalité apporte:

+++ Copie de la date et de l'heure dans le presse-papier +++[hdr24-1]
La description de ce script est: "Copier la date et l'heure dans le presse-papier".

Ce script est rangé dans la catégorie "État système" du dialogue "Gestes de commande" de NVDA.

Il se lance à l'aide de la commande "KEY_COPY_DATETIME" de l'interpréteur.
Aucun geste de commande ne lui est attribué.

Il permet comme sa description l'indique de copier la date et l'heure dans le presse-papier.

+++ Script pour remplacer le script de base "NVDA+f12" +++[hdr24-2]
L'extension installe un script dont la description est : "Annoncer l'heure. Deux appuis : annoncer la date. Trois appuis : copier la date et l'heure dans le presse-papier".

Ce script est rangé dans la catégorie "État système" du dialogue "Gestes de commande" de NVDA.

Aucune commande de l'interpréteur ne lui est associée.

Si l'état d'installation de la fonctionnalité est "Installer", ce script remplace le script de NVDA et se lance à l'aide du geste de commande "NVDA+f12".

Sinon aucun geste de commande ne lui est affecté, mais il est toujours possible de lui en attribuer un à l'aide du dialogue "Gestes de commandes" de NVDA.

Ce script permet :
- au premier appui du geste: l'annonce de l'heure actuelle.
- au second appui: l’annonce de la date actuelle.
- au troisième appui: la copie de la date et de l'heure dans le presse-papier.


Il apporte aussi:

++++ Annonce de l'heure indépendante du niveau de ponctuation ++++
Le geste de commande de base "NVDA + f12" donne l'heure sur un simple appui, mais l'heure n'est pas annoncée de la même façon suivant le Niveau de ponctuations et symboles sélectionné dans les paramètres vocaux.

Ce script corrige ce petit défaut en annonçant l'heure avec le Niveau de ponctuations et symboles forcé à "Aucun" sans modifier le niveau défini dans les paramètres vocaux.

++++ Annonce de l'heure avec les secondes ++++
Par défaut, le geste de commande de NVDA "nvda+f12" annonce l'heure sans les secondes.

Ce script offre la possibilité de faire annoncer l'heure avec les secondes.

Il suffit de cocher la case à cocher "Dire l'heure avec les secondes" se trouvant dans la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension. Cette option n'est pas cochée par défaut.

Cette option n'est pas présente si l'état d'installation de la fonctionnalité est "Ne pas installer".


++ Émulation de la touche "Applications" ++[hdr25]
Pour pallier l'absence de la touche "Applications" sur certains ordinateurs et ne sachant pas si le raccourci "majuscule+f10" remplit la même fonction, l'extension installe un script sans geste de commande dans la catégorie "Touches émulées du clavier du système" avec la description "Émuler l'appui de touche: Applications".

Pour l'utiliser, il suffira de lui affecter un geste de commande ou une touche du clavier très peu utilisée, comme par exemple la touche "impression écran", la touche "Pause".

++ Fermeture de toutes les fenêtres ++[hdr26]
L'extension installe un script pour fermer toutes les fenêtres ouvertes.

Ce script est rangé dans la catégorie des scripts de l'extension et sous la description "Fermer toutes les fenêtres ouvertes".

Il se lance avec la commande "KEY_CLOSE_ALL_WINDOWS" de l'interpréteur de commande. Aucun geste de commande ne lui est affecté par défaut.


++ Lister les extensions en fonctionnement ++[hdr27]
Le gestionnaire d'extensions ou l'add-on store présente la liste de toutes les extensions installées et leur état: activée ou désactivée.

Mais bien qu'étant activée, il se peut qu'une extension ne soit pas chargée par NVDA. En principe, le journal de NVDA signale ce fait, mais rien dans le gestionnaire d'extensions, ni dans l'add-on sstore.

Il peut être intéressant à un moment donné de connaître les extensions qui sont réellement en fonctionnement.

Pour cela, l'extension installe un script sous la description "Afficher la liste des extensions en fonctionnement" dans la catégorie de l'extension dans le dialogue "Gestes de commande".

Ce script se lance avec la commande "KEY_RUNNING_ADDONS" de l'interpréteur de commande. Aucun geste de commande ne lui est affecté.

Les extensions sont listées par type:
- extension globale : c'est une extension qui apporte un complément d'accessibilité quelle que soit l'application sous le curseur.
- extension application : c'est une extension qui apporte un complément d'accessibilité pour une application bien précise.
- extension pilote de synthèse vocale : c'est une extension qui installe un pilote pour une synthèse vocale.
- extension pilote d'afficheur braille : c'est une extension qui installe un pilote pour un afficheur braille.
- extension mixte : c'est une extension qui mélange les différents types d'extension précédents.


++ Outils de développement ++[hdr22]
Cette fonctionnalité n'est pas installée par défaut.

Elle installe le script dont la description est "Afficher le dialogue présentant les outils pour le développement d'extensions".

Ce script est rangé dans la catégorie "Outils" du dialogue "gestes de commande" de NVDA.

Ce script se lance à l'aide de la commande "KEY_TOOLSFORADDON" de l'interpréteur. Aucun geste de commande ne lui est assigné.

L'activation de ce script fait apparaître un dialogue présentant:
- la liste des extensions installées,
- un bouton pour mettre à jour, pour l'extension sélectionnée, la version définie dans le fichier buildVars.py,
- un bouton pour mettre à jour le fichier "manifest.ini" de l'extension sélectionnée avec les informations de son fichier "buildVars.py",
- un bouton pour créer, pour l'extension sélectionnée, le fichier catalogue (.pot),
- un bouton pour préparer l'extension sélectionnée (exécute en une seule fois plusieurs actions),
- la liste des langages supportés par l'extension sélectionnée,
- un bouton pour créer, pour l'extension sélectionnée, le fichier "manifest.ini" de localisation pour une ou toutes les langues qu'il supporte,
- un bouton pour créer, pour l'extension sélectionnée, ses fichiers de documentation en HTML,
- un bouton pour créer, pour l'extension sélectionnée, le fichier "buildVars.py" à partir des informations de son fichier manifest.ini,
- un bouton pour ouvrir dans l'explorateur le dossier de l'extension sélectionnée.


+++ Notions +++
Pour packager une extension (créer le fichier d'installation de l'extension), il est conseillé d'utiliser le modèle "nvda adon scons template".
Ce modèle utilise un fichier "buildVars.py" qui définit, pour une extension, toutes les informations nécessaires comme par exemple: son nom interne, sa version, son nom et sa description à traduire dans chaque langue supportée par lui.
Ce modèle est aussi utilisé pour permettre la traduction des chaînes de caractères de l'extension avec le système de traduction mise en place par la communauté "NVDA-addon.org".

L'objectif de ce modèle est, quand une extension a été mise au point, par simple commande et après avoir renseigné le fichier "buildVars.py" de:
- créer le fichier manifest.ini",
- créer tous les fichiers "manifest.ini" de localisation,
- compiler tous les fichiers .po,
- créer les fichiers html de documentation,
- enfin créer le fichier .nvda-addon d'installation de l'extension.


Quand on crée une extension, il n'y a rien. Il faut par soi-même créer le fichier "manifest.ini", éventuellement le fichier "manifest.ini" de localisation et le fichier de documentation.

L'objectif de ces outils se place dans cette condition et est:
- d'une part, de se rapprocher du modèle "adon scons template" pour qu'il soit assez facile de packager l'extension que l'on a fini de mettre au point,
- d'autre part, de tester tout ou partie avant d'utiliser le modèle pour créer l'extension.


+++ Création du fichier buildVars.py +++[hdr22-1]
La première étape est de créer le fichier "buildVars.py" à partir des informations du fichier "manifest.ini" que l'on a créé pour la mise au point de l'extension.

Le bouton "Créer le fichier buildVars.py" lance cette opération.

C'est uniquement ce fichier que l'on modifiera ensuite pour mettre à jour le fichier "manifest.ini" (changement de version ou de description par exemple).

Pour être utilisé avec le modèle "adon scons template", il faudra le compléter en renseignant les informations qui ne se trouvent pas dans le fichier "manifest.ini".

+++ Mise à jour de la version de l'extension +++[hdr22-2]
Le bouton "Mettre à jour la version de l'extension" permet de modifier la version définie dans le fichier buildVars.py de l'extension sélectionnée.

Il présente une boite de dialogue contenant une zone d'édition initialisée avec la version courante du fichier.

L'appui sur le bouton "OK" enregistre la nouvelle version dans le fichier.



+++ Mise à jour du fichier manifest.ini +++[hdr22-3]
Le fichier "manifest.ini" doit être mis à jour dès que le fichier "buildVars.py" est modifié.

Utiliser le bouton "Mettre à jour le fichier manifest.ini" pour cela.

+++ Création de fichier "manifest.ini" de localisation +++[hdr22-4]
Toute modification de l'information "addon_summary" ou "addon_description" du fichier "buildVars.py" nécessite la traduction de cette description dans chaque langue supportée par l'extension (prise en compte dans le fichier nvda.po et compilation de ce fichier).

Pour que le gestionnaire d'extensions ou l'add-on store présente ces informations à l'utilisateur pour la langue choisie pour NVDA, il faut créer ou mettre à jour le fichier "manifest.ini" de localisation pour cette langue.

Le bouton "Créer le fichier manifest.ini de localisation" permet cela. Il est possible de mettre à jour le fichier pour la langue sélectionnée ou pour toutes les langues.

+++ Création de la documentation HTML +++[hdr22-5]
Les fichiers de La documentation de l'extension peuvent être soit au format "markdown"(.md) soit au format "txt2tags" (.t2t).

Pour être présenté à l'utilisateur dans un navigateur, ces fichiers doivent être convertis en HTML.

Cela est possible simplement à l'aide du bouton "Créer les fichiers HTML de documentation" après avoir sélectionnée l'extension dans la liste des extensions et choisi un langage ou l'ensemble des langages dans la liste des langages.

Ouvert dans le navigateur, ces fichiers HTML ont besoin de fichiers de style (style.css pour les fichiers Markdown et style_t2t.css pour les fichiers txt2tags) placé dans le dossier doc de l'extension.


+++ Création du fichier catalogue +++[hdr22-6]
Le bouton "Créer le fichier POT" permet de créer le fichier catalogue de l'extension sélectionnée.

Une fois créé, ce fichier est placé dans le dossier "locale\en" de l'extension et est nommé "nom-version.pot" où "nom" est le nom de l'extension et "version" sa version.

+++ Préparation de l'extension +++[hdr22-7]
Le bouton "Préparer l'extension" lance, pour l'extension sélectionnée, l'exécution des actions suivantes:
- mise à jour de son fichier "manifest.ini" à partir du fichier "buildVars.py",
- création du fichier "manifest.ini" de localisation pour chaque langue supportée,
- création des fichiers HTML de documentation,
- création du fichier catalogue.


+++ Exploration du dossier de l'extension +++[hdr22-8]
Le bouton "Explorer le dossier de l'extension" ouvre l'explorateur Windows dans le dossier de l'extension sélectionnée.

++ Gestion des configurations utilisateur ++[hdr30]
+++ Présentation +++
Cette fonctionnalité a pour objectif de permettre à l'utilisateur de relancer NVDA avec la configuration utilisateur de son choix.

Pour cela, elle s'appuie sur la possibilité que NVDA offre à l'utilisateur d'indiquer le chemin du répertoire de la configuration dans la ligne de commande qui lance NVDA.

Tous les paramètres de la configuration sont enregistrés dans un dossier bien précis du disque dur et par défaut ce dossier se situe :
- pour un NVDA installée, dans le dossier "c:\Users\NomUtilisateur\AppData\Roaming" et se nomme "nvda".
- pour une copie portable: dans le dossier programme de cette copie et se nomme "userConfig".


Mais ce dossier de configuration peut avoir un autre nom et se situer ailleurs sur le disque dur ou clé USB.

Pour demander à NVDA de l'utiliser, il suffit de l'indiquer en lançant NVDA avec la ligne de commande :
nvda.exe -c "chemin du dossier de configuration"

Si le répertoire n'existe pas, NVDA le crée à son démarrage et l'initialise comme lors du premier lancement après son installation.

Sinon, NVDA démarre en utilisant les paramètres de ce dossier de configuration.

Il est donc possible d'avoir plusieurs configurations utilisateur avec un même NVDA.

Cela permet ainsi par exemple d'avoir, en plus de la configuration de base, soit une configuration de test pour essayer de nouvelles extensions, soit une configuration avec un paramétrage bien précis pour une situation particulière.

Cette fonctionnalité fournit donc le moyen de :
- définir les configurations utilisateur qui seront utilisées,
- d'initialiser de nouvelles configurations en important des paramètres d'une autre configuration,
- de lancer NVDA avec la configuration de son choix sans avoir besoin d'utiliser la ligne de commande.


+++ Gestion des dossiers de configuration utilisateur +++[hdr30-1]
Avant toute chose, il faut définir les configurations qui seront utilisées.

Pour cela, l'extension installe le script "Afficher le dialogue pour gérer les configurations utilisateur" qui se lance à l'aide de la commande de l’interpréteur "KEY_USER_CONFIG_MANAGEMENT".

Aucun geste de commande ne lui est affecté, mais il est toujours possible de le faire à l'aide du dialogue "Gestes de commande" de NVDA.

Cette commande permet l'affichage du dialogue "Gestionnaire des configurations utilisateur" qui présente :
- la liste des dossiers de configuration utilisables,
- le bouton "Redémarrer NVDA avec ce dossier de configuration",
- le bouton "Modifier ou préparer ce dossier",
- le bouton "Ajouter un nouveau dossier",
- le bouton "Ajouter un dossier existant",
- le bouton "Supprimer ce dossier",
- le bouton "Vider ce dossier",
- le bouton "Explorer ce dossier",
- le bouton "Fermer" pour fermer le dialogue.


La liste contient tous les dossiers ajoutés par l'utilisateur et celui ajouté automatiquement par l'extension.

Le dossier de la configuration active est signalé vocalement et par le symbole "coché devant son nom.

Au premier affichage de ce dialogue, l'extension le place automatiquement dans la liste et l'enregistre.

Pour ce dossier, les boutons "Supprimer ce dossier" et "Vider ce dossier" ne sont pas présents.

Un dossier nouvellement ajouté qui n'est pas encore un dossier de configuration est signalé par un Point d'interrogation.

Un dossier de configuration de NVDA est caractérisé par son contenu. Il doit contenir, en particulier, les éléments suivants :
- le dossier "addons",
- le dossier "profiles",
- le dossier "updates",
- le fichier "nvda.ini".


Le bouton "modifier ce dossier" n'est pas présent si le dossier sélectionné est le dossier de configuration active.


++++ Ajout de dossier ++++[hdr30-1-1]
Les boutons "Ajout d'un nouveau dossier" et "Ajout d'un dossier existant" permettent d'ajouter un dossier dans la liste des dossiers de configuration.

L'appui sur le premier bouton affiche le dialogue "Ajout d'un nouveau dossier" qui présente :
- une zone d'édition pour saisir l'identifiant du dossier,
- une zone d'édition pour saisir le chemin de l'emplacement du dossier,
- le bouton "Parcourir..." pour aller rechercher l'emplacement du dossier,
- le bouton "Ajouter" pour valider et ajouter le dossier dans la liste,
- le bouton "Annuler".


L'identifiant du dossier permet de nommer le dossier comme cela: "nvdaUserConfig-identifiant".

C'est sous ce nom que le dossier apparaît dans la liste et sur le disque dur ou USB.

L'appui sur le second bouton fait apparaître le dialogue "Ajout d'un dossier existant" qui présente :
- une zone d'édition pour saisir le chemin complet du dossier existant,
- le bouton "Parcourir..." pour aller rechercher ce dossier,
- le bouton "Ajouter" pour valider la saisie,
- le bouton "Annuler".


++++ Suppression de dossier ++++[hdr30-1-2]
Le bouton "Supprimer le dossier" permet de supprimer le dossier sélectionné de la liste et de l'effacer du disque.

Ce bouton n'est pas présent si le dossier de configuration sélectionné est celui de la configuration active.

La confirmation de suppression pour cette action sera demandée.

++++ Préparation ou modification du dossier ++++[hdr30-1-3]
Suivant que le dossier est un dossier de configuration ou pas, le dialogue présente respectivement :
- soit le bouton "Modifier le dossier",
- soit le bouton "Préparer ce dossier".


Ils ont pour objectif de fournir les outils pour importer des paramètres d'un autre dossier de configuration.

L'activation de ces boutons affiche chacun son propre dialogue qui ne se différencie que par leur titre.

Dans ces dialogues, nous trouvons :
- la liste des dossiers à partir duquel l'importation se fera (seuls les dossiers de configuration sont présentés),
- le bouton "Importer des extensions",
- le bouton "Importer les dictionnaires de parole",
- le bouton "Importer les prononciations de symbole ou ponctuation",
- le bouton "Importer les modifications de gestes de commande",
- le bouton "Importer les profils de configuration",
- le bouton "Importer les paramètres de NVDA (configuration normale)",
- le bouton "Importer toute la configuration",
- le bouton "Fermer" pour terminer le dialogue.


Le nom du dossier qui sera modifié est indiqué dans le titre du dialogue.

L'action de chaque bouton concerne le contenu du dossier sélectionné dans la liste.

Pour l'importation d'extensions, il est possible d'importer tout ou partie des extensions du dossier sélectionné et de garder ou pas les extensions déjà incluses dans le dossier à modifier. Même chose pour l'importation de profils.

L'importation de toute la configuration permet de dupliquer complètement le dossier sélectionné et d'avoir ainsi une copie identique de la configuration de ce dossier.

++++ Redémarrage de NVDA avec une autre configuration ++++[hdr30-1-4]
Le bouton "Redémarrer NVDA avec ce dossier" permet de relancer NVDA avec la configuration du dossier sélectionné.

Ce dossier peut être :
- soit un dossier de configuration complet : NVDA redémarrera avec les paramètres de ce dossier.
- soit un dossier incomplet (marqué par un point d'interrogation) : NVDA redémarrera en initialisant ce dossier et en utilisant les paramètres qui y ont été inclus par importation.


Pour que cette autre configuration puisse bénéficier de la même possibilité de redémarrage, il est nécessaire que cette extension y soit aussi installée.

Dans ce cas, il ne sera pas nécessaire de refaire l'ajout de dossier de configuration. L'extension reprendra les dossiers précédemment enregistrés.

Cet enregistrement se fait dans le fichier "NVDAExtensionGlobalPlugin-userConfigs.ini" stocké dans :
- le dossier programme de NVDA si c'est une copie portable,
- le dossier "AppData\Roaming" de l'utilisateur si c'est un NVDA installé.


++++ Exploration du dossier de configuration ++++[hdr30-1-5]
Le bouton "Explorer ce dossier" permet d'ouvrir le dossier de configuration sélectionné dans l'explorateur.



+++ Exemples d'utilisation +++
++++ Démarrage de NVDA avec une nouvelle configuration vierge ++++
- taper "NVDA+j" suivi de "KEY_USER_CONFIG_MANAGEMENT" pour afficher le dialogue "Gestionnaire des configurations utilisateur".
- appuyer sur le bouton "Ajouter un nouveau dossier".
- saisir l'identifiant du dossier de configuration (par exemple "MonDossierDeConFiguration"),
- choisir l'emplacement du dossier de configuration : par défaut c'est le dossier programme de NVDA, mais il peut être ailleurs sur le disque dur et Même sur une clé USB.
- appuyer sur le bouton "Ajouter": le dossier apparaît dans la liste avec un point d'interrogation et est sélectionné.
- appuyer sur "Redémarrer NVDA avec ce dossier de configuration".


NVDA redémarre et initialise la configuration comme lors d'un démarrage après installation.

++++ Démarrage de NVDA avec une configuration identique ++++
Après les 5 premières étapes:
- appuyer sur le bouton "Préparer ce dossier" pour faire apparaître le dialogue.
- appuyer sur le bouton "Importer toute la configuration" et patienter car cela demande un certain temps.
- appuyer sur le bouton "Redémarrer NVDA avec ce dossier de configuration".


++++ Démarrage de NVDA avec une configuration existante ++++
- taper "NVDA+j" suivi de "KEY_USER_CONFIG_MANAGEMENT".
- appuyer sur le bouton "Ajouter un dossier existant".
- choisir le chemin du dossier de configuration : il peut Même être sur une clé USB.
- appuyer sur le bouton "Ajouter" : le dossier apparaît dans la liste et est sélectionné.
- appuyer sur "Redémarrer NVDA avec ce dossier de configuration".


++++ Transfert de la configuration active d'un ordinateur sur un autre ordinateur via une clé USB ++++
- sur l'ordinateur source, lancer le "Gestionnaire des configurations utilisateur" ("NVDA+j" suivi de "KEY_USER_CONFIG_MANAGEMENT"),
- appuyer sur le bouton "Ajouter un nouveau dossier",
- saisir l'identifiant du dossier de configuration (par exemple "MonDossierDeConfiguration",
- choisir le dossier racine de la clé USB comme emplacement du dossier de configuration,
- appuyer sur le bouton "Ajouter": le dossier apparaît dans la liste avec un point d'interrogation et est sélectionné.
- appuyer sur le bouton "Préparer ce dossier" pour faire apparaître le dialogue "Préparation du dossier nvdaUserConfig-MonDossierDeConfiguration".
- dans la liste "Importer à partir du dossier" de ce dialogue, sélectionner le dossier de configuration active (celui qui est coché),
- appuyer sur le bouton "Importer toute la configuration" et attendre la fin de l'importation. Cela peut demander un certain temps. La copie de la configuration active est alors sur la clé USB.


Dans l'ordinateur cible, Placer la clé USB et noter sa lettre de lecteur.
Nous allons maintenant lancer le NVDA de l'ordinateur cible avec ce dossier de configuration.
Deux solutions :
- soit en utilisant le dialogue "Gestionnaire des configurations utilisateur" si cette extension y est installée, (voir l'exemple précédent).
- soit en utilisant l'option qui permet de lancer avec un autre dossier de configuration (voir ci-après).


Pour utiliser l'option :
- sur le bureau de cet ordinateur, se trouve l'icône du NVDA installé.
- copier cet icône et renommer le, par exemple, en "NVDA - MonDossierDeConfiguration". C'est avec lui que NVDA va être relancé.
- ouvrez les propriétés de cet icône et modifier sa cible en ajoutant après un espace: -c "E:\MonDossierDeConfiguration" (E étant la lettre de lecteur de la clé USB). Valider par "OK".
- enfin, lancer NVDA avec cet icône.



À cette étape, NVDA a donc chargé la configuration du dossier de configuration de la clé USB.
Il est alors possible avant de remplacer l'ancienne configuration, de procéder à des tests afin de s'assurer de son bon fonctionnement.
Ensuite, pour installer cette configuration :
- lancer le dialogue "Gestionnaire des configuration utilisateur" ("NVDA+j" suivi de "KEY_USER_CONFIG_MANAGEMENT").
- dans la liste "Dossiers de configuration", choisir le dossier de configuration natif de NVDA: "NVDA".
- appuyer sur le bouton "Modifier ce dossier" pour afficher le dialogue "Modification du dossier NVDA".
- dans la liste "Importer à partir du dossier" de ce dialogue, choisir le dossier de configuration active (celui qui est coché).
- appuyer sur le bouton "Importer toute la configuration" et confirmer.
- appuyer sur le bouton "Préparer ce dossier" pour faire apparaitre le dialogue "Préparation du dossier nvdaUserConfig-MonDossierDeConfiguration".
- dans la liste "Importer à partir du dossier" de ce dialogue, sélectionner le dossier de configuration active (celui qui est coché).
- appuyer sur le bouton "Importer toute la configuration", confirmer l'importation et attendre la fin de celle-ci. Cela peut demander un certain temps.


Il ne reste plus qu'à lancer le NVDA installé soit par son icône de bureau, soit par "alt+control+n".


++ Analyse de texte ++[hdr31]
Cette fonctionnalité est en expérimentation.

Lors de la modification ou relecture d'un document en utilisant uniquement la parole, des incohérences telles que des parenthèses sans correspondance, des changements de mise en forme involontaires, des espaces supplémentaires et des signes de ponctuation parasites ou non espacés peuvent souvent être manquées.

La fonctionnalité "Analyse de texte" installe un outil (analyseur) qui vous avertit de ces irrégularités, à l'aide d'un message vocal ou d'un fichier WAV lors d'une relecture par mot ou par ligne.

Vous pouvez configurer l'analyseur pour qu'il annonce ces irrégularité par nombre, par description ou par son.

L'analyse est décomposée en trois groupes de recherche :
- recherche des non concordances entre symboles,
- recherche d'anomalies : multiple espaces contigus, espace ou tabulation en fin de ligne, ponctuations isolées ou mal espacées, majuscules manquantes ou mal placées, espaces manquants ou inattendus avant ou après une ponctuations,
- recherche des changements de mise en forme : nom de police, couleur, taille, attributs, style.
- recherche des fautes d'orthographe.


Il est possible de désactiver un groupe de recherche ainsi que, de manière individuelle, chaque action d'un groupe.

Pour cela, est ajoutée la catégorie "Analyse de texte" dans le dialogue de paramétrage de l'extension.

Les paramètres de cette catégorie sont spécifiques au profil actif qui est annoncé quand la catégorie est sélectionnée.


+++ Activation / désactivation de l'analyseur +++[hdr31-1]
L'analyseur peut être activé ou désactiver de trois manière :
- à l'aide de la commande "KEY_TEXT_ANALYZER" de l'interpréteur,
- à l'aide de la case à cocher "Activer l'analyseur de texte" située dans la catégorie "Analyse de texte" du dialogue de paramétrage de l'extension,
- à l'aide du script "Activer ou désactiver l'analyseur de texte" : aucun geste de commande ne lui est affecté mais il est possible de le faire en utilisant le dialogue "Gestes de commande" de NVDA.


L'activation et la désactivation de l'analyseur ne concerne que le profil de configuration actif.

La case à cocher "Activer l'analyseur de texte au démarrage de l'extension" se trouvant dans la catégorie "Analyse de texte" fixe, pour chaque profil, l'état d'activation de l'analyseur de texte au lancement de l'extension.

L'analyseur activé, l'analyse se fait à chaque déplacement du curseur de mot en mot, ou de ligne en ligne dans les zones d'édition de texte.

Le résultat de l'analyse est signalé selon le choix fait, par :
- un bip sonore : la fréquence et la longueur du bip est configurable.
- un message vocal : par défaut, c'est "Alerte", mais cela peut être modifié.
- un son choisi parmi une liste.
- un message vocal donnant le nombre d'irrégularités trouvées.
- un message vocal donnant la description détaillée des irrégularités trouvées.


Pour la configuration de l'alerte, voir le groupe "Alerte" de la catégorie "Analyse de texte".

+++ Configuration de l'analyse +++[hdr31-2]
++++ Recherche des non concordances de symboles ++++[hdr31-2-1]
Elle est activée par défaut.

Certains symboles comme les parenthèses, les crochets, les accolades vont en générale par paires : un symbole ouvrant, un symbole fermant.

Cette recherche consiste à vérifier cette concordance.

Les symboles possibles sont recensés dans la liste "symboles" du groupe "Concordance de symboles" de la catégorie "Analyse de texte".

Chaque symbole peut ou ne pas faire partie de la recherche suivant son état coché ou décoché dans la liste.

Les symboles de la liste dépendent du langage choisi pour NVDA. Ils sont définis dans le fichier "textAnalyzer.ini" placé dans le dossier associé au langage du dossier "locale".


++++ Recherche d'anomalies ++++[hdr31-2-2]
Cette recherche est activée par défaut.

La liste des anomalies à recherchées est présentée dans le groupe "Anomalies" de la catégorie "Analyse de texte".

Ce sont :
- Les multiples espaces contigus,
- L'espace ou la tabulation à la fin,
- La ponctuation isolée ou non espacée,
- Les majuscules manquantes ou inversées,
- L'espace obligatoire avant le symbole,
- L'espace obligatoire après le symbole,
- L'espace inattendu avant le symbole,
- L'espace inattendu après le symbole.


Dans la liste, ce sont des cases à cocher. Par défaut, elles sont toutes cochées. En décochant une case, la vérification la concernant ne se fera pas.

Pour les anomalies concernant les espaces autour d'un symbole, les symboles impliqués sont signalés par coché dans la liste contenant tous les symboles prévus. Suivant le besoin, il est possible de cocher ou décocher tel ou tel symbole. Les symboles cochés par défaut sont définis pour chaque langage de NVDA le nécessitant dans le fichier "textAnalysis.ini" placé dans le dossier du langage du dossier "locale".

++++ Recherche de changement de mise en forme ++++[hdr31-2-3]
Cette recherche est désactivée par défaut.

Les changements de mise en forme peuvent être signalés par l'analyseur en fonction de l'état de la case à cocher "Signaler les changements" du groupe "Mise en forme" de la catégorie "Analyse de Texte".

Les changements de mise en forme concernent :
- le nom de police,
- la taille de police,
- les attributs de police,
- la couleur,
- le style.


Ils peuvent être inclus ou exclus individuellement de la recherche en les cochant ou décochant dans la liste "Types" du même groupe.

++++ Recherche des fautes d'orthographe ++++[hdr31-2-4]
Cette recherche est activée par défaut.


+++ Analyse à la demande +++[hdr31-3]
L'extension installe des scripts pour analyser sur demande le texte se trouvant à la position du curseur.

Ces scripts sont:
- "Analyser le mot sous le curseur" : "MAIN_KEY_WORD_TEXT_ANALYZER", commande de l'interpréteur "KEY_WORD_TEXT_ANALYZER",
- "Analyser la ligne sous le curseur" : "MAIN_KEY_LINE_TEXT_ANALYZER", commande interpréteur "KEY_LINE_TEXT_ANALYZER",
- "Analyser la phrase sous le curseur" : "MAIN_KEY_SENTENCE_TEXT_ANALYZER", commande interpréteur "KEY_SENTENCE_TEXT_ANALYZER".
- "Analyser le paragraphe sous le curseur" : "MAIN_KEY_PARAGRAPH_TEXT_ANALYZER", commande interpréteur "KEY_PARAGRAPH_TEXT_ANALYZER".


+++ Déplacement du curseur à la prochaine/précédente irrégularité +++[hdr31-4]
Les scripts suivants permettent de déplacer le curseur à la prochaine/précédente irrégularité:
- déplacer le curseur à la prochaine irrégularité: commande interpréteur "KEY_MOVETONEXTALERT_ANALYZER",
- déplacer le curseur à la précédente irrégularité: commande interpréteur "KEY_MOVETOPREVIOUSALERT_ANALYZER",


La recherche de l'irrégularité s'effectue dans une plage de 100 lignes. Si aucune irrégularité n'est trouvée dans cette plage, une demande est faite à l'utilisateur pour continuer la recherche dans une nouvelle plage.

Aucun geste de commande n'est associé à ces deux scripts, mais il est possible de le faire en utilisant le dialogue "Geste de commande". Ils sont placés dans la catégorie "ADDON_SUMMARY".

++ Annonce de la position du curseur dans les zones d'édition ++[hdr32]
Le script "Activer/ désactiver l'annonce de la position courante du curseur dans une zone d'édition" permet de faire annoncer ou pas la position du curseur lorsqu'il se trouve dans une zone d'édition.

Cette position est relative au début de la ligne sur laquelle se trouve le curseur.

L'activation ou désactivation de cette annonce est propre au profil courant.

Le script est installé sans geste de commande et avec la commande de l'interpréteur "KEY_POSITION_REPORT".

Si désiré, le dialogue "Geste de commande" de NVDA permet de lui attribuer un geste de commande.

++ Périphérique de sortie audio temporaire ++[hdr33]
Cette fonctionnalité est installée par défaut.

Elle permet de changer temporairement le périphérique de sortie audio en cours par un autre périphérique de sortie audio sans impacter la configuration de NVDA et ceci pour tous les profils de configuration.

Chaque profil de configuration conservera les paramètres configurés dans la catégorie "Parole" utilisé par NVDA, y compris son périphérique de sortie audio.

Nous nommerons ce périphérique "Périphérique audio temporaire".

Quand un périphérique audio temporaire est actif, le son audio (messages vocaux et tonalités) émis par NVDA sera envoyé à ce périphérique quel que soit le périphérique de sortie audio du profil de configuration actif.

Les sons émis par le système continue à être envoyer au périphérique de sortie audio sélectionné dans les paramètres de Windows.

Comme rien n'est modifié dans la configuration de NVDA, l'enregistrement automatique ou manuel de celle-ci ne garde aucune trace de ce périphérique.

Pour retrouver le fonctionnement normal, c'est à dire l'utilisation des périphériques de sortie audio des profils de configuration, il suffira d'abandonner le périphérique audio temporaire.

Pour réaliser tout cela, l'extension installe plusieurs scripts.

+++ Gestionnaire du périphérique audio temporaire +++[hdr33-1]
Ce script a comme description "Afficher le gestionnaire du périphérique audio temporaire" et est placé dans la catégorie "Parole" du dialogue "Gestes de commandes" de NVDA.

Aucun geste de commande ne lui est affecté, mais il est toujours possible de lui attribuer un à l'aide de ce dialogue.

Il se lance à l'aide de la commande "KEY_TEMPORARY_AUDIO_DEVICE_MANAGER" de l'interpréteur de commandes.

En réponse à cette commande, s'affiche le dialogue "Gestionnaire du périphérique audio temporaire" qui présente:
- la zone de texte "Périphérique audio temporaire actuel": elle indique le périphérique audio temporaire actif.
- la liste déroulante qui liste les périphériques de sortie audio du système.
- le bouton "Définir comme périphérique audio temporaire",
- le bouton "Abandonner le périphérique audio temporaire",
- le bouton "Fermer".


Dans la liste, le déplacement se fait à l'aide des flèches de direction "haut" et "bas".

Lorsqu'un périphérique est sélectionné, un double bip se fait entendre à sa sortie pour permettre de vérifier son bon fonctionnement ou raccordement et ainsi ne pas l'activer.

Le basculement vers le périphérique sélectionné se fait soit en appuyant sur le bouton "Définir comme périphérique audio temporaire" (bouton par défaut), soit si le focus est dans la liste, avec la touche "Entrée".

Ce périphérique devient le périphérique audio temporaire.

Le son émis par NVDA est alors dirigé vers la sortie de ce périphérique.

Afin de ne pas se retrouver avec un périphérique qui n'émet aucun son, l'extension demande à l'utilisateur s'il confirme l'utilisation de ce périphérique.
Cette demande est faite après le basculement sur ce périphérique et est temporisée.

Elle peut être empêchée à l'aide de l'option "Demander une confirmation" se trouvant dans le groupe "Périphérique audio temporaire" de la catégorie "ordinateur" du dialogue "Paramètres" de l'extension.

Cette demande de confirmation consiste en l'affichage d'une boite de dialogue pendant un temps limité et demandant à l'utilisateur d'accepter l'utilisation du nouveau périphérique de sortie audio.

Le temps d'affichage de cette boite de dialogue est lui aussi paramétrable à l'aide de la liste déroulante "Temps maximum d'attente de la confirmation (en secondes)" se trouvant dans le même groupe que l'option précédente.

L'appui sur le bouton "OK" ou la touche "Entrée" valide l'acceptation.

À l'échéance du délai sans appui sur le bouton "OK" ou la touche "Entrée", la boite se referme et le son revient sur le précédent périphérique de sortie audio.

Pour revenir au fonctionnement normal, c'est à dire sans périphérique audio temporaire, il suffit de relancer le script et d'activer le bouton "Abandonner le périphérique audio temporaire" ou plus brutalement redémarrer NVDA.

Dans la liste des périphériques de sortie audio, il est possible de cocher certains périphériques. Ces périphériques serviront pour le script "Définir, comme périphérique audio temporaire, le périphérique suivant dans la liste des périphériques cochés du gestionnaire du périphérique audio temporaire" (voir ci-après).

+++ Changement de périphérique audio temporaire +++[hdr33-2]
Pour changer de périphérique, deux moyens:
- soit en lançant le script précédent et en choisissant un autre périphérique,
- soit en utilisant le script (voir ci-dessous) qui permet de boucler entre les périphériques cochés dans le gestionnaire du périphérique audio temporaire.


Ce script a comme description "Définir, comme périphérique audio temporaire, le périphérique suivant dans la liste des périphériques cochés du gestionnaire du périphérique audio temporaire" et est placé dans la catégorie "Parole" du dialogue "Gestes de commandes".

Aucun geste de commande ne lui est affecté. Mais il est toujours possible de le faire à l'aide du précédent dialogue.

Il se lance à l'aide de la commande "KEY_SET_TEMPORARY_AUDIO_DEVICE" de l'interpréteur de commande.

À chaque lancement du script, un nouveau périphérique de sortie audio est défini comme périphérique audio temporaire.

Ce périphérique est choisi parmi les périphériques qui ont étaient précédemment cochés dans la liste des périphériques de sortie audio du dialogue "Gestionnaire du périphérique audio temporaire" (voir ci-dessus). Celui qui est sélectionné est celui qui suit dans la liste, le périphérique de sortie audio actuel.

Après changement de périphérique, aucune confirmation n'est demandée.

+++ Abandon du périphérique audio temporaire +++[hdr33-3]
Ce script a comme description "Abandonner le périphérique audio temporaire" et est placé dans la catégorie "Parole" du dialogue "Gestes de commandes".

Aucun geste de commande ne lui est affecté. Mais il est toujours possible de le faire à l'aide du précédent dialogue.

Il se lance à l'aide de la commande "KEY_LEAVEUP_TEMPORARY_AUDIO_DEVICE" de l'interpréteur de commande.

Le script n'a aucun effet si aucun périphérique audio temporaire n'est actif.

Sinon, la sortie audio de NVDA est alors dirigée vers le périphérique de sortie audio du profil de configuration actif.

+++ Définition ou abandon du périphérique audio temporaire +++[hdr33-4]
Ce script a comme description "Définir, comme périphérique audio temporaire, le périphérique suivant dans la liste des périphériques cochés du gestionnaire du périphérique audio temporaire. Deux appuis: abandonner le périphérique audio temporaire".

Aucun geste de commande ne lui est affecté. Mais il est toujours possible de le faire à l'aide du précédent dialogue.

Aucune commande de l'interpréteur ne lui est non plus affectée.

Ce script réunit les deux scripts précédents sous un seul script.

Le premier appui du geste de commande lance le script "Définir, comme périphérique audio temporaire, le périphérique suivant dans la liste des périphériques cochés du gestionnaire du périphérique de sortie audio temporaire ".

Le second appui dans un temps rapproché, lance le script "Abandonner le périphérique audio temporaire".

+++ Précisions techniques +++
Pour réaliser cette fonctionnalité, les fonctions "speak" et "speakSpelling" du module "speech.speech.py" de NVDA ont été remplacées. Les fonctions de remplacement sont communes avec la fonctionnalité "Historique des annonces vocales ".
Cela peut poser des problèmes si d'autres extensions l'ont également fait.
Pour conserver le bon fonctionnement des autres extensions, il faut désinstaller ces deux fonctionnalités.


pour réaliser cette fonctionnalité, la fonction playWaveFile du module nvwave.py de NVDA a été remplacée.Cette modification est commune avec la fonctionnalité "Modification du gain des fichiers son de NVDA".
Dans le cas où le remplacement de cette fonction pose problème, il faut à la fois, désinstaller cette fonctionnalité et décocher l'option "Permettre la modification du gain".

Enfin, pour réaliser cette fonctionnalité, les fonctions "initialize" du module "tones", "setSynth" du module "synthDriverHandler" et "_maybeInitPlayer" de la class "SynthDriver" du module "synthDrivers.oneCore" ont été modifiées.
Dans le cas où ces modifications posent problème ou entre en conflit avec d'autres extensions, il faut désinstaller cette fonctionnalité.


++ Orientation de la sortie audio de NVDA ++[hdr34]
Cette fonctionnalité permet de séparer le son de NVDA du son émis par les autres sources audio et ainsi d'entendre dans une oreille, le son de NVDA et dans l'autre oreille, le son des autres sources audio.
Seuls les applications avec une source audio à deux canaux et utilisant le même périphérique de sortie audio sont concernées.

Elle permet aussi de régler le niveau du volume des tonalités émises par NVDA (quand Wasapi n'est pas utilisé, possible avec les versions de NVDA antérieures à la 2025.1) et de modifier le gain des fichiers son de NVDA et de l'extension.

Elle est installée par défaut.

Pour l'orientation du son, techniquement, le basculement à droite ou à gauche du son consiste à mettre à zéro le niveau du volume des canaux audio droits ou gauches de NVDA et des sources audio.
Pour recentrer une source audio, les deux canaux sont mis au même niveau. Ce niveau est le plus fort niveau des deux canaux.
Pour basculer une source d'un coté à l'autre, le niveau du canal étant mis à zéro est pris comme niveau pour l'autre canal si celui-ci est à zéro.


NVDA étant une application monophonique, le même son est joué sur les deux canaux. Il n'y a pas de perte audio phonique à mettre un canal à zéro.

Mais ce n'est pas le cas pour les applications stéréophoniques.

Pour orienter le son de NVDA, l'extension installe les scripts suivants :
- Entendre NVDA à droite et le son de la source audio de l'application sous le curseur à gauche (commande : KEY_SPLIT_RIGHT_FOCUS),
- Entendre NVDA à droite et le son de toutes les sources audio à gauche (commande : KEY_SPLIT_RIGHT_ALL),
- Entendre NVDA à gauche et le son de la source audio de l'application sous le curseur à droite (commande : KEY_SPLIT_LEFT_FOCUS),
- Entendre NVDA à gauche et le son de toutes les sources audio à droite (commande : KEY_SPLIT_LEFT_ALL),
- Entendre NVDA et le son de la source audio de l'application sous le curseur au centre (commande : KEY_SPLIT_CENTER_FOCUS),
- Entendre NVDA et le son de toutes les sources audio au centre (commande : KEY_SPLIT_CENTER_ALL)
- Entendre le son de la source audio de l'application sous le curseur au centre (commande : KEY_CENTER_FOCUSED_APP)
- Afficher le Gestionnaire des sources audio (commande : KEY_SOUND_SPLIT_MANAGER)


Aucun geste de commandes ne leur est affecté. Mais il est toujours possible de le faire en utilisant le dialogue "Gestes de commandes" de NVDA. Ces scripts se trouvent sous la catégorie "Contrôle du son" de ce dialogue.

La commande "KEY_CENTER_FOCUSED_APP" est opérationnelle même si la fonctionnalité n'est pas installée afin, éventuellement, de pouvoir rééquilibrer l'audio de certaines applications restées déséquilibrées après la désinstallation de la fonctionnalité.



+++ Gestionnaire des sources audio +++[hdr34-1]
Le dialogue "Gestionnaire des sources audio" permet, outre l'orientation du son de NVDA, de:
- fixer le niveau de volume des deux canaux audio de NVDA et des sources audio,
- régler le volume des tonalités de NVDA quand Wasapi n'est pas utilisé (possible avec les versions de NVDA antérieures à la 2025.1),
- modifier le gain des fichiers son de NVDA.


Il présente :
- la liste des périphériques de sortie audio,
- la liste des sources audio pour le périphérique de sortie audio sélectionné,
- le potentiomètre pour modifier le volume de la source sélectionnée,
- sauf pour la source "NVDA", la case à cochée pour modifier l'état "muet" de la source sélectionnée,
- les potentiomètres pour modifier les niveaux des canaux gauche et droite de la source sélectionnée,
- pour seulement la source "NVDA" et sans Wasapi, le potentiomètre pour régler le volume des tonalités émis par NVDA et le bouton pour modifier le gain des fichiers son,
- pour seulement la source "NVDA", le bouton pour modifier le gain des fichiers son.


Le périphérique de sortie audio que Windows utilise par défaut est signalé.

Quand la liste est focalisée, les commandes suivantes sont permises :
- entendre la source audio sélectionnée à droite : "flèche droite",
- entendre la source audio sélectionnée à gauche : "flèche gauche",
- entendre la source audio sélectionnée au centre : "espace",
- Entendre NVDA à droite et la source audio sélectionnée à gauche : "majuscule + flèche droite",
- Entendre NVDA à gauche et la source audio sélectionnée à droite : "majuscule + flèche gauche",
- Entendre NVDA et la source audio sélectionnée au centre : "majuscule + espace",
- Entendre NVDA à droite et toutes les sources audio à gauche : "contrôle + flèche droite",
- Entendre NVDA à gauche et toutes les sources audio à droite : "contrôle + flèche gauche",
- Entendre NVDA et toutes les sources audio au centre : "contrôle + espace",
- augmenter ou diminuer d'un pas, le volume de la source audio sélectionnée : "contrôle + flèche haut ou bas",
- augmenter ou diminuer d'un double pas, le volume de la source audio sélectionnée : "contrôle + page précédente ou suivante",
- maximiser ou minimiser le volume de la source audio : "contrôle + début ou fin",
- couper ou rétablir le son de la source audio : "contrôle + m",
- augmenter ou diminuer d'un pas le volume principal : "contrôle +majuscule + flèche haut ou bas",
- augmenter ou diminuer d'un double pas, le volume principal : "contrôle + majuscule + page précédente ou suivante",
- maximiser ou minimiser le volume principal : "contrôle + majuscule + début ou fin".


Certaines commandes ne sont pas disponibles quand NVDA n'est pas dans la liste des sources audio du périphérique sélectionné.

Cette liste est automatiquement rafraîchie lorsque le curseur lui est donné.

Les modifications de basculement de canaux ou les changements de niveaux de volume sont appliquées immédiatement après chaque commande.
Par défaut, le niveau de volume des sources audio ne peut pas être plus grand que le niveau du volume principal. Mais l'option "Augmenter le volume principal si nécessaire" permet de désactiver cette limitation. Cette option se trouve dans le groupe "Modification du volume" de la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension.

Par défaut et quand wasapi n'est pas utilisé, le niveau des tonalités de NVDA est fixé à 50 qui est la valeur de base de NVDA définie en interne.

Une protection est prévue pour éviter de mettre, simultanément, à zéro le niveau des canaux audio de NVDA et que son niveau de volume soit plus petit que son seuil de rétablissement configuré.

Lorsqu'une source audio est sélectionnée, l'état de balance des canaux est annoncé ainsi que l'état de coupure du son.

Quand la liste des périphériques de sortie audio est focalisée, la sélection d'un périphérique déclenche l'émission d'une tonalité vers ce périphérique. Il est possible d'empêcher cette émission en décochant l'option "Jouer une tonalité sur le périphérique de sortie audio" du groupe "Gestionnaire des sources audio" de la catégorie "Avancé" des paramètres globaux de l'extension.

Dans cette liste, les commandes suivantes sont disponibles:
- augmenter ou diminuer d'un pas le volume principal : "contrôle +majuscule + flèche haut ou bas",
- augmenter ou diminuer d'un double pas, le volume principal : "contrôle + majuscule + page précédente ou suivante",
- maximiser ou minimiser le volume principal : "contrôle + majuscule + début ou fin".


++++ Modification du gain des fichiers son de NVDA et de l'extension ++++[hdr34-2]
Lorsque la source NVDA est sélectionnée, le bouton "Changer le gain des fichiers son" est alors activable.
L'appui sur ce bouton ouvre le dialogue "Modification du gain des fichiers son de NVDA" qui présente:
- la liste des sons utilisés par NVDA et l'extension,
- le bouton "Jouer" qui permet d'écouter le son sélectionné,
- la liste de choix du gain: une valeur positive amplifie le son, une valeur négative le réduit.
- le bouton "Tester" qui permet d'écouter le résultat de la modification du son avec le gain sélectionné,
- le bouton "Appliquer le gain" pour appliquer le gain au son sélectionné,
- le bouton "Appliquer le gain à tous les sons" pour appliquer le gain à tous les sons,
- le bouton "Réinitialiser le son sélectionné" pour remettre le son sélectionné comme il était à l'installation de NVDA,
- le bouton "Réinitialiser tous les sons" pour remettre tous les sons comme ils étaient à l'installation de NVDA.


Les sons de NVDA sont présentés dans la liste par une description traduisible.

Les sons de l'extension sont présenté par un préfixe, un "_" et le nom du fichier son.
Le préfixe désigne l'origine du fichier son: NVDAExtensionGlobalPluginSounds ou NVDAExtensionGlobalPluginSoundsTextAnalyzerAlerts.


Si le gain est à zéro, les boutons "Tester", "Appliquer le gain" et "Appliquer le gain à tous les sons" ne sont pas présents.

L'appui sur le bouton "Appliquer le gain" modifie le son d'origine et enregistre le résultat dans un autre fichier son. C'est ce fichier son qui sera alors utilisé. Le bouton "Réinitialiser le son" permet de revenir au son d'origine en effaçant ce nouveau fichier.

Les sons modifiés sont signalés dans la liste avec l'indication "modifié". Ils sont tous rangés dans le dossier "NVDAExtensionGlobalPlugin-NVDAWaves" créé pour la circonstance dans le dossier de configuration utilisateur. Ce dossier n'existe pas si aucun son n'est modifié.

Si le son sélectionné n'a pas était modifié, le bouton "Réinitialiser le son" n'est pas présenté.

S'ils n'y a pas de sons déjà modifiés dans la liste des sons, le bouton "Réinitialiser tous les sons" n'est pas présenté.

Le son du démarrage de NVDA ne peut pas être modifié car il est joué avant le chargement de l'extension.

Il est possible de ne pas autoriser la modification du gain des sons en décochant la case à cocher "Permettre la modification du gain des fichiers son" se trouvant dans la catégorie "Avancé". Cette case est cochée par défaut.



+++ Précisions technique +++
Pour réaliser la fonctionnalité du réglage du volume des tonalités de NVDA quand Wasapi n'est pas utilisé ( possible seulement avec les versions de NVDA antérieures à la 2025.1), l'extension a modifié le fonctionnement de la fonction "beep" du module "tones" de NVDA.
Cela peut poser problème si une autre extension l'a aussi modifié.
Pour éviter ce genre de conflit, l'extension donne la possibilité de ne pas activer cette fonctionnalité en décochant l'option "Permettre le réglage du volume des tonalités de NVDA" qui se situe dans la catégorie "Avancé" des paramètres de l'extension. Dans ce cas, il n'y aura pas de modification de la fonction "beep" par l'extension.

Si Wasapi est utilisé, cette option n'est pas présente car le réglage des tonalités et des sons de NVDA se fait par NVDA lui-même.

Par défaut, Cette option est cochée.

Pour que les fichiers son modifiés soient joués à la place des sons originaux, la fonction playWaveFile du module nvwave.py de NVDA a été remplacée. Cette fonction de remplacement est commune avec la fonctionnalité "Périphérique audio temporaire".

Dans le cas où la modification de cette fonction pose problème, il faut à la fois, décocher l'option "Permettre la modification du gain" et désinstaller cette fonctionnalité.


++ Activation ou désactivation rapide des extensions ++[hdr35]
Pour activer ou désactiver les extensions, NVDA propose nativement le gestionnaire d'extensions ou, depuis NVDA 2023.2, l'add-on store.

Cependant dans certains cas, il peut être nécessaire de désactiver tout ou partie des extensions en ne laissant que quelques extensions activées.

Avec le gestionnaire d'extensions ou l'add-on store, il est alors nécessaire de passer en revue chaque extension pour l'activer ou la désactiver à l'aide d'un bouton ou menu.

Cette extension tente de rendre plus rapide cette manipulation et pour cela, elle apporte un script pour afficher le dialogue "Activation rapide des extensions".

Ce script se lance à l'aide de la commande "KEY_QUICK_ADDONS_ACTIVATION" de l'interpréteur. Aucun geste de commande ne lui est associé. Mais il est possible de le faire en utilisant le dialogue "Gestes de commandes" de NVDA.
Il se trouve dans la catégorie "ADDON_SUMMARY" avec la description "Afficher le dialogue pour activer ou désactiver les extensions".

Ce dialogue présente :
- la liste des extensions installées, activées ou désactivées,
- le bouton "Cocher tout" pour cocher toutes les extensions de la liste,
- le bouton "Décocher tout" pour décocher toutes les extensions de la liste,
- le bouton "Enregistrer et redémarrer NVDA" pour valider les changements et redémarrer NVDA,
- le bouton "Annuler" pour fermer le dialogue sans aucune modification de l'état d'activation des extensions.


Si l'extension est installée sous une version de NVDA antérieures à la 2023.2 de NVDA, La liste ne présente que les extensions compatibles. 

Seules les extensions dans un état stable sont listées. Les extensions qui sont dans un état intermédiaire c'est à dire soit en attente d'activation ou de désactivation, soit en attente d'installation ou de suppression en sont exclues.

Depuis NVDA 2023.2, les extensions incompatible sont inclues aussi dans la liste, et peuvent être activées ou désactivées elles aussi.

Elles sont signalées par la mention "(incompatible)" à la suite de leur identifiant.

À l'affichage du dialogue, les extensions activées sont cochées.

La liste est rafraichie à chaque activation de la fenêtre du dialogue afin de prendre en compte tout changement éventuel d'état des extensions.

Pour changer l'état d'activation d'une extension, il suffit, soit de la cocher pour l'activer, soit de la décocher pour la désactiver.

Les changements ne seront pris en compte que lors de l'appui sur le bouton "Enregistrer et redémarrer NVDA".


+ Options +
++ Suppression de l'annonce de la description des objets dans les rubans Windows ++[hdr100]

Dans les rubans Windows, NVDA est trop bavard sans nécessité.
Par défaut, cette extension empêche l'annonce de la description qui semble bien inutile.

Mais ceci peut être désactivé à l'aide de l'option "Ne pas annoncer la description des objets dans les rubans Windows" qui se trouve dans la catégorie "Ordinateur" du dialogue "Paramètres de l'extension".

Un redémarrage de NVDA sera alors nécessaire pour la prise en compte de l'option.


++ Agrandissement automatique des fenêtres ++[hdr102]
Cette option permet d'agrandir automatiquement les fenêtres qui sont mises au premier plan.

Par défaut, elle est activée.

Vous pouvez la désactivée en décochant l'option "Agrandir automatiquement les fenêtres" de la catégorie "Ordinateur" du dialogue "Paramètres" de l'extension.

++ Déplacement du curseur ++
+++ Annonce des ponctuations lors de déplacement par mot +++[hdr103-1]
NVDA permet, dans les documents, de se déplacer mot par mot à l'aide des commandes clavier "contrôle+ flèche droite" et "contrôle + flèche gauche".

Les symboles et ponctuations sont alors dites suivant le niveau de ponctuations et symboles configuré pour le profil de configuration courant.

Cette option permet de configurer le niveau de symboles et de ponctuations qui sera utilisé uniquement lors de déplacement par mot.

Ce choix est enregistré pour le profil de configuration courant.

Elle se configure dans la catégorie "Compléments à NVDA" du dialogue de Paramétrage du profil de configuration courant" de l'extension.

Elle n'est présente que si la fonctionnalité "Annonce de la fonction associée aux commandes d'édition du style "copier", "Coller" est installée.

Elle se présente sous la forme d'une liste qui permet de choisir :
- soit le niveau de symboles et ponctuations du niveau de configuration courant (sélectionné par défaut),
- soit un des niveaux de symboles et ponctuations de NVDA (Aucun, quelques un, la plupart, tous).


+++ Ne pas dire vide lors de déplacement par ligne +++[hdr103-2]
Lors de déplacement par ligne et quand NVDA rencontre une ligne sans caractère annonçable, il dit "vide".

Cette option permet de modifier ce comportement et de ne rien annoncer.

Cette option est configurable par profil de configuration.

Elle n'est pas activée par défaut.

++ Signalement des fautes d'orthographes ++[hdr104]
NVDA peut signaler les fautes d'orthographe :
- lors de la frappe du texte et quand un mot est tapé.
- en lecture : déplacement par ligne, par mot ou en dire tout.

Pour cela, deux options de NVDA sont impliquées :
- l'option "Faute d'orthographe" du groupe " Information sur le document" de la catégorie "Mise en forme des documents".
- l'option "Jouer un son pour les fautes d'orthographe pendant la frappe " de la catégorie "Clavier".

Pour que NVDA signale les fautes en lecture et lors de la frappe, il faut que l'option "Fautes d'orthographe" soit activée. Les fautes sont alors signalées par le message vocal "Faute d'orthographe".

Pour que les fautes soient signalées plutôt par un son lors de la frappe, il faut que l'option "Jouer un son pour les fautes d'orthographe pendant la frappe " soit activée.

L'extension modifie ce comportement de NVDA de la manière suivante :
- l'option "Jouer un son pour les fautes d'orthographe pendant la frappe " est renommée en "Pendant la frappe, signaler les fautes d'orthographe".
- le signalement des fautes d'orthographe en lecture et lors de la frappe sont indépendants. Si l'option "Fautes d'orthographe" n'est pas active, mais que l'option "Pendant la frappe, signaler les fautes d'orthographe" l'est, les fautes seront signalées lors de la frappe.
- pour chaque situation, en lecture ou lors de la frappe, il est possible de configurer comment seront signalées les fautes : par un double bip, par le son de NVDA, par le message vocal "Faute d'orthographe" ou par l'annonce du mot mal orthographié sous un profil de configuration dédié.


Le choix du signalement des fautes d'orthographe se fait dans le groupe "Signalement des fautes d'orthographe" de la catégorie "Compléments à NVDA" des paramètres globaux de l'extension, à l'aide des listes déroulantes "Lors de la frappe, signalé par" et "En lecture, signalé par".

Les choix possibles de ces listes déroulantes sont :
- bip sonore : un double bip sera émis.
- son : le son de NVDA sera joué.
- message : "le message vocal Faute d'orthographe sera entendu.
- annonce du mot mal orthographié : le mot mal orthographié sera entendu avec les paramètres vocaux du profil de configuration "Annonce des mots mal orthographiés" dédié et ajouté par l'extension. Ce profil sera automatiquement activé lors de l'annonce d'un mot mal orthographié. Ce profil vous permet de modifier par exemple le synthétiseur ou la voix qui va être utilisé pour l'annonce du mot mal orthographié.


Le profil "Annonce des mots mal orthographiés" est associé à un déclencheur dédié et non présent dans la liste des déclencheurs. Il ne faut pas l'associé à un autre déclencheur.

Note :
- si vous effacé le profil "Annonce des mots mal orthographiés", l'extension le recréera au prochain démarrage de NVDA, mais les paramètres de ce profil seront les mêmes que ceux du profil "Configuration normale".
- Le nom de ce profil est la traduction dans la langue de NVDA du terme "Spelling errors announcement". Donc si vous lancer dans une autre langue NVDA, l'extension créera un autre profil ayant comme nom, la traduction de ce terme dans cette langue. Le précédent profil n'est pas supprimé.
- dans le cas où le signalement des fautes d'orthographe se fait vocalement, il est préférable de désactiver l'option "Interruption de la parole à la frappe d'un caractère " de la catégorie "Clavier" des paramètres de NVDA car toute frappe rapide de caractère après un mot arrête l'annonce vocale.


Attention: cette fonctionnalité est incompatible avec l'extension "speakTypingWords". Si celle-ci est installé, la fonctionalité concernant le signalement des fautes d'orthographe pendant la frappe est restreinte:
- l'option "Pendant la frappe, Signaler les fautes d'orthographe " n'est plus disponible si l'option "Faute d'orthographe"  n'est pas cochée (fonctionnement de base de NVDA).
- si le choix du signalement des fautes d'orthographe pendant la frappe s'est porté sur "annonce du mot mal orthographié", ce sera le son d'erreur classique de NVDA qui sera joué si une faute est détectée. 



++ Blocage des touches "Insertion" et "Verrouillage" ++[hdr105]
(Disponible pour les versions de NVDA inférieurs à 2023.1 si la fonctionnalité "Annonce sélective des touches de commande " est installée)

Il peut être utile dans certains cas d'empêcher l'action des touches "Insertion" et "Verrouillage majuscule".

Leur rôle initial est:
- La touche "Insertion" peut faire passer du mode "Insertion" au mode "Refrappe" et inversement.
- La touche "Verrouillage majuscule" simule l'enfoncement permanent de la touche "Majuscule".


NVDA permet à l'utilisateur de définir ces touches comme touche "NVDA". Mais dans ce cas, la touche "Insertion" comme la touche "Verrouillage majuscule" ne joue leur rôle initial que s'il y a un double appui rapide.

Par configuration, L'extension donne la possibilité que ces touches n'aient pas d'action quand elles sont dans leur rôle initial.

Cette configuration se fait par profil de configuration à l'aide d'une case à cocher pour chaque touche (Voir le groupe "Blocage de touches" de la catégorie "Clavier" du profil courant).

Quand l'action de la touche est bloquée, un bip sonore se fait entendre.

++ Prononciation des caractères non alphanumériques quand l'écho clavier par caractère est désactivé ++[hdr106]
Cette option permet de faire prononcer les caractères non alphanumériques quand l'écho clavier par caractères est désactivé.

Cela permet à certains utilisateurs d'entendre, par exemple, les symboles de ponctuation tapés, même s'ils ont désactivé l'écho clavier par caractère.

Elle se configure à l'aide de la case à cocher "Prononcer quand même les caractères non alphanumériques quand l'écho clavier par caractère est désactivé" qui se trouve dans la catégorie "Clavier" pour le profil de configuration courant.

Par défaut, elle n'est pas cochée.


+ Options avancées +
++ Signalement par son de l'inscription d'une erreur dans le journal de NVDA ++[hdr300]
Les utilisateurs expérimentés ont pu remarquer que lorsqu'ils utilisent une version de développement de NVDA (version snapshot master ou next), toute erreur inscrite dans le journal de NVDA est signaler par un son. Mais avec les versions finales ou releases candidates, ce signal n'est pas émis.

Cette option offre le choix entre :
- diffuser le signal sonore quel que soit la version de NVDA,
- de ne jamais diffuser le signal,
- de ne diffuser le signal que jusqu'au prochain démarrage de NVDA,
- de diffuser le signal seulement pour les versions de développement.


Pour faire ce choix, il suffit de sélectionner l'option dans la liste déroulante nommée "Jouer un son lors de l'inscription d'une erreur dans le journal" de la catégorie "Avancés" du dialogue "Paramètres" de l'extension. Par défaut, l'option "Seulement pour les versions de développement" est sélectionnée.

++ Titrage des boites de dialogue avec le nom de l'extension ++[hdr302]
Cette option permet de titrer ou non les boites de dialogue de cette extension avec son nom.
Elle se trouve dans la catégorie "Avancées" du dialogue "Paramètres" de l'extension.

Par défaut, cette option est cochée et le titre des boites se présente sous la forme: "ADDON_SUMMARY - NVDA - titre du dialogue ".


++ Configuration de la temporisation d'attente de répétition du même geste de commande ++[hdr303]
Certains scripts de cette extension réalisent différentes actions suivant le nombre de fois où le geste de commande associé au script est composé.
La répétition du geste de commande doit se faire dans un bref délai (500 ms par défaut).

Pour un script réalisant trois actions différentes, le mécanisme est :
- Au premier appui, la temporisation est lancée,
- s'il n'y a pas de second appui avant l'échéance de la temporisation, la première action est réalisée. Sinon la temporisation est relancée à ce second appui.
- s'il n'y a pas de troisième appui avant l'échéance de la temporisation, la seconde action est réalisée. Sinon, la temporisation est arrêtée et la troisième action est réalisée.


Suivant la dextérité de l'utilisateur ou la configuration matérielle, cette temporisation peut être trop longue ou trop courte.

L'option intitulée "Temporisation d'attente de répétition du même geste de commande" de la catégorie "Avancés" du dialogue "Paramètres" de l'extension permet d'ajuster cette temporisation suivant le besoin.

++ Utilisation standard du pavé numérique ++[hdr304]
Par défaut, NVDA utilise certaines touches du pavé numérique, comme les touches de direction, les touches "multiplier", "diviser" et la touche "plus", pour activer des scripts.

L'objectif est de rendre à chaque touche du pavé numérique, de manière temporaire ou permanente, son fonctionnement normal, composé seule ou avec une touche de modification comme "contrôle", "Alt","majuscule" (La touche "NVDA" est exclue).

Ces touches sont:
- les touches "flèches droite et gauche",
- les touches "flèches haut et bas",
- les touches "page précédente et suivante",
- les touches "début et fin",
- les touches "multiplier" et "diviser",
- la touche "Plus".


Pour activer ou désactiver l'utilisation du pavé numérique en fonctionnement standard et si l'option "Autoriser l'utilisation standard du pavé numérique" du groupe "Pavé numérique" de la catégorie "Clavier" est cochée, l'extension offre:
- un script dont la description est "Activer ou désactiver l'utilisation standard du pavé numérique". Aucun geste de commande ne lui est affecté par défaut.
- la commande "KEY_TOGGLE_NUMPAD_NAVIGATION" de l'interpréteur de commande.
- l'activation par deux appuis successifs sur la touche "Verrouillage numérique" si l'option "Activer / désactiver l'utilisation standard du pavé numérique avec la touche verrouillage numérique"(groupe "Pavé Numérique, catégorie "Clavier") est cochée.



L'option "Activer l'utilisation standard du pavé numérique au démarrage de NVDA " (groupe "Pavé numérique, catégorie "Clavier"), permet, si elle est cochée, d'utiliser le pavé numérique de manière standard dès le démarrage de NVDA, mais il faut aussi que l'option qui autorise l'utilisation standard du pavé numérique soit cochée.

++ Gestion du verrouillage numérique ++[hdr305]
Cette fonctionnalité est reprise en partie de l'extension "sharedComputer" (auteurs "Robert Hänggi <aarjay.robert@gmail.com>, Noelia Ruiz Martínez <nrm1977@gmail.com>" qui semble ne pas avoir été mise à jour depuis 2018.

Elle consiste en :
+++ Signalement de l'activation du verrouillage lors du démarrage de NVDA +++
Par défaut et en disposition de clavier "Ordinateur de bureau", l'extension signale que le verrouillage numérique est activé lors du démarrage de NVDA.

Mais ceci peut être désactivé, comme c'est le cas par défaut pour la disposition de clavier "ordinateur portable", à l'aide de l'option "Signaler l'état activé au démarrage de NVDA" du groupe "Verrouillage numérique" de la catégorie "Clavier" des paramètres de l'extension.


+++ Activation/désactivation automatique lors de l'activation d'un profil de configuration +++
À chaque activation d'un profile de configuration, il est possible d'activer ou de désactiver automatiquement le verrouillage numérique.

Le choix se fait dans les paramètres du profil de configuration, dans la catégorie "Clavier" du groupe "Verrouillage numérique" et avec la liste de choix "Lors de l'activation du profil: ".

Cette liste propose les choix suivants:
- "Ne rien faire" : l'état du verrouillage n'est pas modifié.
- "Désactiver" : le verrouillage est désactivé.
- "Activer" : le verrouillage est activé.


Par défaut, le choix est :
- "Désactiver" pour une disposition de clavier "Ordinateur de bureau".
- "Ne rien faire" pour une disposition de clavier "ordinateur portable".


++ Verrouillage majuscule ++[hdr306]
Par défaut, au démarrage de NVDA, l'état du verrouillage majuscule est signalé.

Ce signalement peut être désactivé en décochant l'option "Signaler l'état activé au démarrage de NVDA" du groupe "Verrouillage majuscule" de la catégorie "Clavier" des paramètres globaux de l'extension.

++ Limitation de répétition de touches ++[hdr307]

Lorsqu'une touche est enfoncée et pas relâchée suffisamment rapidement, Windows génère une série d'appui- touches qui peuvent être gênants surtout dans une zone d'édition.

Cette fonctionnalité tente de limiter ce nombre d'appui-touches au minimum.

Elle est contrôlée par la case à cochée "Limiter les répétitions" qui se trouve dans le groupe "Répétition de touches" de la catégorie "Avancée" des paramètres globaux de l'extension et par le délai de répétition qui se configure dans le même groupe.

Quand cette option est cochée, tout nouvel appui de la même touche qui arrive dans un délai inférieur au délai de répétition configuré est ignoré.

Par défaut, cette case n'est pas cochée et le délai de répétition est fixé à 100 millisecondes

Il n'est pas possible de ne garder que le seul premier appui-touche car le délai avec l'appui qui suit est trop grand (de l'ordre de 500 millisecondes).

Les touches de modifications ne sont pas concernées par cette limitation.


+ Autres améliorations +

++ Exploration du dossier de configuration ou dossier programme de NVDA++[hdr202]
Cette extension ajoute dans le menu "outils" de NVDA un sous-menu "Explorer NVDA" qui propose deux éléments de choix:
- "explorer mon dossier de configuration": pour ouvrir dans l'explorateur de Windows son dossier utilisateur.
- "Explorer le dossier programme" : pour ouvrir dans l'explorateur le dossier programme de NVDA.


Deux scripts, rangés dans la catégorie "ADDON_SUMMARY" du dialogue "Gestes de commande" de NVDA, sont prévus pour réaliser ces mêmes actions et avec les descriptions suivantes:
- "Ouvrir dans l'explorateur mon dossier de configuration",
- "Ouvrir dans l'explorateur le dossier programmes de NVDA".


Par défaut, aucun geste de commande ne leur est associé.

++ Présentation de la mise en forme du texte dans une boite de dialogue ++[hdr203]
De base, un double appui du geste de commande "NVDA + f" présente les informations de mise en forme sous la forme d'un document HTML.

Ce script a pour but de les compléter et les afficher plutôt dans une boite de dialogue afin de pouvoir les lire en utilisant les flèches de direction.

Il se lance à l'aide de la commande "KEY_REPORT_FORMATTING" de l'interpréteur.


La description du script est: "Afficher, dans une boite de dialogue, les informations de mise en forme à la position actuelle du curseur de revue dans un document".

Il est rangé sous la rubrique "ADDON_SUMMARY" du dialogue "Gestes de commande de NVDA".

Aucun geste de commande ne lui est affecté par défaut.

++ Annonce du texte des boites de dialogues du style confirmation++[hdr204]
NVDA considère pour certaines boites de dialogue comme celles de confirmation, que le texte qu'elles contiennent est une description.

Donc si l'option "Annoncer la description de l'objet" de la catégorie "Présentation des objets" du dialogue "Paramètres" De NVDA n'est pas cochée, le texte n'est pas annoncé par NVDA.

Cette extension met en place l'option "Ne pas tenir compte de l'option Annoncer la description de l'objet lors de l’affichage des boite de dialogue du style confirmation" dans la catégorie "Avancés" du dialogue "Paramètres" de l'extension pour forcer, si elle est cochée, l'annonce du texte de ces boites dans tous les cas. Cette option est cochée par défaut.

++ Exécution des scripts dans le dialogue "Gestes de commandes" de NVDA++[hdr205]
Le dialogue "Gestes de commandes" de NVDA , permet de configurer les gestes de commandes (raccourcis clavier, boutons d'un afficheur braille, etc) pour les scripts (appelés commandes dans le guide utilisateur de NVDA) disponibles à cet instant. Pour plus d'informations, voir le chapitre "Gestes de commandes" de ce manuel.

L'extension rend possible l'exécution des scripts dans ce dialogue et ceci même si aucun geste de commande n'est configuré.

Elle modifie ce dialogue en ajoutant le bouton "Exécuter le script" quand un script est sélectionné dans l'arborescence.

Le script peut être exécuté à l'aide d'une des trois actions suivantes:
- soit en appuyant sur ce bouton,
- soit en composant le raccourci associé au bouton,
- soit - en appuyant sur la barre d'espace quand le curseur est sur l'élément de l'arborescence.


En répétant l'action plusieurs fois rapidement, le script sera exécuté autant de fois.
+++ Précisions techniques +++
Pour réaliser cette fonctionnalité, la fonction "onInputGesturesCommand " de "gui.mainFrame" et l'action déclenchée par le sous-menu "Gestes de commandes" ont été remplacées (Modification commune avec la fonctionnalité suivante). Il n'est pas possible d'empêcher cela.

++ Sélection automatique de la catégorie dans le dialogue "Gestes de commandes" ++[hdr206]
Il peut arriver que l'on ait besoin d'ouvrir le dialogue "Gestes de commandes" de NVDA pour connaître les gestes de commandes apportées par l'extension active pour l'application sous le curseur.

Sans extension, c'est la première catégorie qui est sélectionnée par défaut.

Afin de faire gagner du temps, l'extension amène la sélection automatique de la catégorie associée à l'extension active pour l'application sous le curseur.

Pour cela, elle recherche la catégorie parmi les catégories qui fournissent des scripts appartenant à l'extension active. Mais cette dernière peut mettre en place des scripts dans n'importe quelle catégorie.

Cette catégorie sera alors automatiquement sélectionnée et développée.

+++ Précisions techniques +++
Pour réaliser cette fonctionnalité, la fonction "onInputGesturesCommand " de "gui.mainFrame" et l'action déclenchée par le sous-menu "Gestes de commandes" ont été remplacées (Modification commune avec la fonctionnalité précédente). Il n'est pas possible d'empêcher cela.
++ Sélection du dernier paramètre utilisé dans la boucle des paramètres du synthétiseur ++[hdr207]
Les gestes de commandes "NVDA+contrôle+flèche droite ou gauche" de NVDA permettent de passer d'un paramètre à l'autre dans la boucle des paramètres du synthétiseur.

Mais après un redémarrage de NVDA, le dernier paramètre utilisé est oublié.

Cette amélioration tente de pallier cet inconvénient.

Pour cela, l'extension enregistre, à chaque déplacement dans la boucle des paramètres du synthétiseur, le dernier paramètre utilisé pour chaque synthétiseur et pour chaque profil de configuration.

Ce paramètres sera alors de nouveau sélectionné au démarrage de NVDA pour le synthétiseur et pour le profil "configuration normale" ou lors d'un changement de profil.

Attention: comme tous les paramètres de NVDA, il est nécessaire que la configuration de NVDA soit enregistrée avant le redémarrage de NVDA (soit automatiquement, soit manuellement) pour les retrouver après le redémarrage.



++ Compléments pour l'explorateur Windows ++[hdr208]
L'extension apporte les scripts suivants Quand le curseur est dans l'arborescence des dossiers :
+++ Annonce du chemin d'accès du dossier ou du fichier sous le curseur +++
Ce script permet, quand le curseur est positionné sur un des éléments du dossier n de l'arborescence de l'explorateur Windows, de :
- au premier appui : de faire annoncer le chemin d'accès réduit sous la forme : identifiant du lecteur\...\nom du dossier n-3\nom du dossier n-2\nom du dossier n-1\nom du dossier n\nom du fichier ou du dossier.
- au second appui : de faire annoncer le chemin d'accès complet.
- au troisième appui : de copier le chemin complet dans le presse-papier.


Aucun geste de commande, ni commande interpréteur ne lui est affecté par défaut.

La description du script est : "Annoncer le chemin réduit du dossier ou du fichier sous le curseur de l'explorateur Windows. Deux appuis : annoncer le chemin complet. Trois appuis : copier le chemin complet dans le presse-papier".

Il est rangé sous la rubrique "ADDON_SUMMARY" du dialogue "Gestes de commande de NVDA".

Il est possible de lui associer un geste de commande à l'aide de ce dialogue.

Le nombre de dossier à conserver pour le chemin réduit est configurable (voir le groupe "Explorateur Windows " de la catégorie "Ordinateur" des paramètres globaux de l'extension. Par défaut, ce nombre est de 4).

+++ Annonce, en remontant l'arborescence des dossiers, du nom des dossiers composant le chemin du dossier contenant l'élément sous le curseur +++
Ce script permet, comme celui annonçant le chemin réduit, de localiser l'élément sous le curseur sans avoir besoin d'entendre tous les noms des dossiers composants le chemin complet.

Contrairement à l'autre script, il n'est pas limité par la configuration c'est à dire le nombre de dossiers du chemin à conserver.

Il annonce le nom des dossiers composants le chemin en sens inverse, c'est à dire en remontant l'arborescence des dossiers. Cette annonce peut être arrêtée à tout moment en appuyant sur la touche "Contrôle".

Par exemple, si l'élément sélectionné se trouve dans le dossier n, NVDA annoncera dans l'ordre suivant :
- le nom du dossier n suivi de (n),
- le nom du dossier n-1 suivi de (n-1),
- le nom du dossier n-2 suivi de (n-2)
- le nom du dossier n-3 suivi de (n-3),
- et ainsi de suite jusqu'à l'identifiant du lecteur suivi du dernier niveau entre parenthèses.


L'option "Annoncer le nom des dossiers du chemin inversé avec le niveau" permet de ne pas faire annoncer le niveau des dossiers. Elle se trouve dans le groupe "Explorateur Windows" de la catégorie "Ordinateur".



Aucun geste de commande, ni commande interpréteur n'est affecté par défaut à ce script.

La description de ce script est : "Annoncez le chemin du fichier ou du dossier sous le curseur de l'explorateur Windows en remontant l'arborescence des dossiers".

Il est rangé sous la rubrique "ADDON_SUMMARY" du dialogue "Gestes de commande de NVDA".

Il est possible de lui associer un geste de commande à l'aide de ce dialogue.

+ Résumé des commandes apportées par cette extension +
++ Gestes de commande installés systématiquement ++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| KEY_SHELL | KEY_SHELL | Aucun | Lancer l'interpréteur de commandes de l'extension |
| MAIN_KEY_CLIC_LEFT_MOUSE_BUTTON_At_NAVIGATOR | MAIN_KEY_CLIC_LEFT_MOUSE_BUTTON_At_NAVIGATOR | aucune | faire un simple clic gauche à la position de l'objet navigateur. Le deuxième appui fait un double clic |
| MAIN_KEY_CLIC_RIGHT_MOUSE_BUTTON_At_NAVIGATOR | MAIN_KEY_CLIC_RIGHT_MOUSE_BUTTON_At_NAVIGATOR | aucune | faire un simple clic droit à la position de l'objet navigateur. Le deuxième appui fait un double clic |

++ Commandes de l'interpréteur ++

| Commande | Description |
| KEY_APPLICATION_INFORMATIONS | Afficher les informations sur l'application sous le curseur |
| KEY_OBJECTS_LIST | Afficher les éléments visibles composant l'objet en avant plan |
| KEY_TEMPORARY_AUDIO_DEVICE_MANAGER | Afficher le Gestionnaire du périphérique audio temporaire |
| KEY_SET_TEMPORARY_AUDIO_DEVICE | Définir, comme périphérique audio temporaire, le périphérique suivant dans la liste des périphériques cochés du gestionnaire du périphérique audio temporaire |
| KEY_LEAVEUP_TEMPORARY_AUDIO_DEVICE | Abandonner le périphérique audio temporaire |
| KEY_COPY_DATETIME | Copier la date et l'heure dans le presse-papier |
| KEY_RUNNING_ADDONS | Afficher les Extensions en fonctionnement |
| KEY_REPORT_FORMATTING | Afficher, dans une boite de dialogue, les informations de mise en forme à la position actuelle du curseur de revue dans un document |
| KEY_ADDON_SETTINGS | Afficher le dialogue de paramétrage de l'extension |
| KEY_PROFILE_SETTINGS | Afficher le dialogue de paramétrage de l'extension pour le profil de configuration courant |
| KEY_RENAMING | Afficher le dialogue Renommage des touches clavier |
| KEY_SELECTIVE_ANNOUNCEMENT | Afficher le dialogue pour configurer les annonces sélectives des touches de commandes |
| KEY_COMPLEX_SYMBOL | Composer un symbole complexe comme par exemple une voyelle accentuée, un symbole mathématique |
| KEY_LAST_USED_COMPLEX_SYMBOL | Afficher la liste des derniers symboles complexes composés |
| KEY_TOGGLE_NUMPAD_NAVIGATION | Activer ou désactiver l'utilisation standard du pavé numérique |
| KEY_TEXT_ANALYZER | Activer ou désactiver l'analyseur de texte |
| KEY_WORD_TEXT_ANALYZER | Analyser le mot sous le curseur système |
| KEY_LINE_TEXT_ANALYZER | Analyser la ligne sous le curseur système |
| KEY_SENTENCE_TEXT_ANALYZER | Analyser la phrase sous le curseur système |
| KEY_PARAGRAPH_TEXT_ANALYZER | Analyser le paragraphe sous le curseur système |
| KEY_POSITION_REPORT | Activer/ désactiver l'annonce de la position courante du curseur dans une zone d'édition |
| KEY_SOUND_SPLIT_MANAGER | Afficher le gestionnaire audio de NVDA et des applications actives |
| KEY_DISPLAY_SPEECH_HISTORY | Afficher les enregistrements de l'historique vocal |
| KEY_WINDOWS_LIST | Afficher la liste des fenêtres des applications lancées avec la possibilité de basculer vers l'une d'entre elles ou de la détruire |
| KEY_ICONS_List | Afficher la liste des icônes de la zone de notification |
| KEY_MINUTE_TIMER | Afficher le dialogue permettant, si la minuterie est arrêtée, de la lancer ou sinon de consulter la durée restante ou d'arrêter celle-ci |
| KEY_MODULE_GUIDE | Afficher le manuel utilisateur de l'extension |
| KEY_HELP_SHELL | Afficher la liste des commandes de l'interpréteur de commandes |
| KEY_LOG_VIEW | Afficher le dialogue pour gérer les journaux de NVDA |
| KEY_CLOSE_ALL_WINDOWS | Fermer toutes les fenêtres ouvertes |
| KEY_USER_CONFIG_MANAGEMENT | Afficher le dialogue pour gérer les configurations utilisateur |
| KEY_SAY_CURRENT_FOLDERNAME | Annoncer le nom du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer |
| KEY_SAY_CURRENT_FOLDERPATH | Annoncer le chemin complet du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer |
| KEY_VOICE_PROFIL_SWITCHING | Activer ou désactiver le Mode commutation de profil vocal |
| KEY_QUICK_ADDONS_ACTIVATION | Afficher le dialogue pour activer ou désactiver rapidement les extensions |
| KEY_SHUTDOWN | Afficher le dialogue pour arrêter, redémarrer ou mettre en veille prolongée l'ordinateur |
| KEY_TOGGLE_MUTE | Couper ou établir le son pour l'application sous le curseur |
| KEY_VOLUME_ON | Établir le son principal et de NVDA |
| KEY_TOOLSFORADDON | Afficher le dialogue présentant les outils pour le développement d'extensions |
| KEY_USER_INPUT_GESTURE | Afficher le dialogue pour gérer les gestes de commande configurés par l'utilisateur |
| KEY_MANAGE_VOICE_PROFIL | Afficher le dialogue pour gérer les sélecteurs de profil vocal |
| KEY_ADDING_TO_CLIP | Ajouter, dans le presse-papier, le texte sélectionné |
| KEY_CLEAR_CLIP | Vider le presse-papier |
| KEY_REPORT_SPEECH_SETTINGS | Annoncer les paramètres vocaux actuels |
| KEY_DISPLAY_SPEECH_SETTINGS | Afficher les paramètres vocaux actuels |
| KEY_APP_VOLUME_UP | Augmenter le volume de l'application sous le curseur |
| KEY_NVDA_VOLUME_UP | Augmenter le volume de NVDA |
| KEY_MAIN_VOLUME_UP | Augmenter le volume principal |
| KEY_APP_VOLUME_DOWN | Diminuer le volume de l'application sous le curseur |
| KEY_NVDA_VOLUME_DOWN | Diminuer le volume de NVDA |
| KEY_MAIN_VOLUME_DOWN | Diminuer le volume principal |
| KEY_APP_VOLUME_MAX | Maximiser le volume de l'application sous le curseur |
| KEY_NVDA_VOLUME_MAX | Maximiser le volume de NVDA |
| KEY_MAIN_VOLUME_MAX | Maximiser le volume principal |
| KEY_APP_VOLUME_MIN | Minimiser le volume de l'application sous le curseur |
| KEY_NVDA_VOLUME_MIN | Minimiser le volume de NVDA |
| KEY_MAIN_VOLUME_MIN | Minimiser le volume principal |
| KEY_APP_VOLUME_PREVIOUS_LEVEL | Établir le volume de l'application sous le curseur au précédent niveau |
| KEY_NVDA_VOLUME_PREVIOUS_LEVEL | Établir le volume de NVDA au précédent niveau |
| KEY_MAIN_VOLUME_PREVIOUS_LEVEL | Établir le volume principal au précédent niveau |
| Chiffre de 1 à 9 | Établir le volume de l'application sous le curseur à x pourcent du volume principal (x égal à 10 multiplié par le chiffre) |
| Majuscule+chiffre de 1 à 9 | Établir à x le volume de NVDA (x égal à 10 multiplié par le chiffre) |
| Contrôle+chiffre de 1 à 9 | Établir à x le volume principal (x égal à 10 multiplié par le chiffre) |
| KEY_SPLIT_LEFT_FOCUS | Entendre NVDA à gauche et l'application sous le curseur à droite |
| KEY_SPLIT_LEFT_ALL | Entendre NVDA à gauche et toutes les applications à droite |
| KEY_SPLIT_RIGHT_FOCUS | Entendre NVDA à droite et l'application sous le curseur à gauche |
| KEY_SPLIT_RIGHT_ALL | Entendre NVDA à droite et toutes les applications à gauche |
| KEY_SPLIT_CENTER_FOCUS | Entendre NVDA et l'application sous le curseur au centre |
| KEY_SPLIT_CENTER_ALL | Entendre NVDA et toutes les applications au centre |
| KEY_CENTER_FOCUSED_APP | Entendre l'application sous le curseur au centre |

++ Gestes de commande installés par les fonctionnalités ++
+++ Affichage de la liste des icônes de la zone de notification et des fenêtres des applications lancées +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_ICONS_List | MAIN_KEY_ICONS_List | Aucune | Afficher la liste des icônes de la zone de notification. Deux appuis: Afficher la liste des fenêtres des applications lancées avec la possibilité de basculer vers l'une d'entre elles ou de la détruire |

+++ Aide à la composition de symboles complexes +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_COMPLEX_SYMBOL | MAIN_KEY_COMPLEX_SYMBOL | Aucune | Composer un symbole complexe comme par exemple une voyelle accentuée, un symbole mathématique |

+++ Informations sur l'application sous le curseur +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_REPORT_NAME_VERSION | MAIN_KEY_REPORT_NAME_VERSION | Aucune | Annoncer le nom et le numéro de version de l'application sous le curseur. Deux appuis: copier ces informations dans le presse-papier|
| MAIN_KEY_CONFIGURATION_PROFILE | MAIN_KEY_CONFIGURATION_PROFILE | Aucune | Annoncer le nom de fichier de l'application en cours ainsi que le nom du module python chargé. Deux appuis: annoncer le nom et l'état du profil de configuration |

+++ Extension des fonctionnalités du tampon virtuel +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| KEY_CURRENT_ROW_REPORT | KEY_CURRENT_ROW_REPORT | aucun | annoncer les cellules de la ligne courante du tableau |
| KEY_CURRENT_COLUMN_REPORT | KEY_CURRENT_COLUMN_REPORT | aucun | annoncer les cellules de la colonne courante du tableau |
| KEY_NEXT_ROW_REPORT | KEY_NEXT_ROW_REPORT | aucun | Aller à la ligne suivante du tableau et annoncer les cellules de celle-ci |
| KEY_PREVIOUS_ROW_REPORT | KEY_PREVIOUS_ROW_REPORT | aucun | Aller à la ligne précédente du tableau et annoncer les cellules de celle-ci |
| KEY_NEXT_COLUMN_REPORT | KEY_NEXT_COLUMN_REPORT | aucun | Aller à la colonne suivante du tableau et annoncer les cellules de celle-ci |
| KEY_PREVIOUS_COLUMN_REPORT | KEY_PREVIOUS_COLUMN_REPORT | aucun | Aller à la colonne précédente du tableau et annoncer les cellules de celle-ci |
| KEY1_CELL_POSITION_REPORT | KEY2_CELL_POSITION_REPORT | aucun | annoncer la position de la cellule courante du tableau |
| KEY_MOVE_FIRST_CELL_ROW | KEY_MOVE_FIRST_CELL_ROW | aucun | Aller à la première cellule de la ligne du tableau |
| KEY_MOVE_LAST_CELL_ROW | KEY_MOVE_LAST_CELL_ROW | aucun | Aller à la dernière cellule de la ligne du tableau |
| KEY_MOVE_FIRST_CELL_COLUMN | KEY_MOVE_FIRST_CELL_COLUMN | aucun | Aller à la première cellule de la colonne du tableau |
| KEY_MOVE_LAST_CELL_COLUMN | KEY_MOVE_LAST_CELL_COLUMN | aucun | Aller à la dernière cellule de la colonne du tableau |
| KEY1_DOCUMENT_ADDRESS | KEY2_DOCUMENT_ADDRESS | aucun | Annoncer l'adresse (URL) du document. Deux appuis: l'enregistrer dans le presse-papier |

+++ Annonce du dossier présélectionner des boites de dialogue du style Ouvrir, enregistrer, enregistrer sous +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_SAY_CURRENT_FOLDER | MAIN_KEY_SAY_CURRENT_FOLDER | Aucune | Annoncer le nom du dossier sélectionner pour les boites de dialogue du style Ouvrir, Enregistrer. Deux appuis: annoncer son chemin complet |

+++ Journaux de NVDA +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_LOG_VIEW | MAIN_KEY_LOG_VIEW | Aucune | Ouvrir le journal courant de NVDA. Deux appuis: ouvrir son ancien journal. Trois appuis: copier le chemin du journal courant dans le presse-papier |

+++ Historique des annonces vocales +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_PREVIOUS_RECORD | MAIN_KEY_PREVIOUS_RECORD | Aucune | Annoncer le précédent enregistrement de l'historique vocal et le copier dans le presse-papier |
| MAIN_KEY_NEXT_RECORD | MAIN_KEY_NEXT_RECORD | Aucune | Annoncer l'enregistrement suivant de l'historique des annonces vocales et le copier dans le presse-papier |
| MAIN_KEY_CURRENT_RECORD | MAIN_KEY_CURRENT_RECORD | Aucune | Annoncer l'enregistrement courant de l'historique des annonces vocales et le copier dans le presse-papier. Deux appui: afficher tout l'historique |

+++ Minuterie +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_MINUTE_TIMER | MAIN_KEY_MINUTE_TIMER | Aucune | Afficher le dialogue permettant, si la minuterie est arrêtée, de la lancer ou sinon de consulter la durée restante ou d'arrêter celle-ci |

+++ Redémarrage de NVDA +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_RESTART_NVDA | MAIN_KEY_RESTART_NVDA | Aucune | Redémarrer NVDA. Deux appuis: redémarrer en niveau de journalisation débogage |

+++ Affichage des éléments visibles composant l'objet en avant plan +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_OBJECTS_LIST | MAIN_KEY_OBJECTS_LIST | Aucune | Annoncer tous les contrôles dans la fenêtre active. Deux appuis: afficher les éléments visibles composant l'objet en avant plan |

+++ Commutation de profil vocal +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_VOICEPROFILE_SELECTOR | MAIN_KEY_VOICEPROFILE_SELECTOR | Aucune | Positionner le sélecteur x comme sélecteur courant et définir, si possible, son profil vocal associé comme profil vocal courant(x égal chiffre 1 à 8) |
| MAIN_KEY_NEXT_VOICEPROFILE | MAIN_KEY_NEXT_VOICEPROFILE | Aucune | Aller au premier sélecteur suivant associé à un profil vocal et définir ce profil vocal comme profil vocal courant |
| MAIN_KEY_PREVIOUS_VOICEPROFILE | MAIN_KEY_PREVIOUS_VOICEPROFILE | Aucune | Aller au premier sélecteur précédent associé à un profil vocal et définir ce profil vocal comme profil vocal courant |
| MAIN_KEY_MANAGE_SELECTOR | MAIN_KEY_MANAGE_SELECTOR | Aucune | Afficher le dialogue pour gérer les sélecteurs de profil vocal |
| MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING | MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING | aucune | Activer ou désactiver le Mode commutation de profil vocal |

+++ Date et heure- compléments +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| KEY_DATE_TIME | KEY_DATE_TIME | aucune | Annoncer l'heure. Deux appuis: annoncer la date. Trois appuis: copier la date et l'heure dans le presse-papier |

+++ Analyse de texte +++
| Ordinateur de bureau | Ordinateur portable | Tactile | Description |
| MAIN_KEY_WORD_TEXT_ANALYZER | MAIN_KEY_WORD_TEXT_ANALYZER | aucune | Analyser le mot sous le curseur |
| MAIN_KEY_LINE_TEXT_ANALYZER | MAIN_KEY_LINE_TEXT_ANALYZER | aucune | Analyser la ligne sous le curseur |
| MAIN_KEY_SENTENCE_TEXT_ANALYZER | MAIN_KEY_SENTENCE_TEXT_ANALYZER | aucune | Analyser la phrase sous le curseur |
| MAIN_KEY_PARAGRAPH_TEXT_ANALYZER | MAIN_KEY_PARAGRAPH_TEXT_ANALYZER | aucune | Analyser le paragraphe sous le curseur |
